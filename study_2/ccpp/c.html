<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>C Primer Plus | 庞希</title>
    <meta name="generator" content="VuePress 1.5.0">
    
    <meta name="description" content="computer science">
    <link rel="preload" href="/assets/css/0.styles.978437f2.css" as="style"><link rel="preload" href="/assets/js/app.3a4d85d6.js" as="script"><link rel="preload" href="/assets/js/2.df84aaee.js" as="script"><link rel="preload" href="/assets/js/11.7b015660.js" as="script"><link rel="prefetch" href="/assets/js/10.1aa92065.js"><link rel="prefetch" href="/assets/js/12.1f234f4e.js"><link rel="prefetch" href="/assets/js/13.b4eae37b.js"><link rel="prefetch" href="/assets/js/14.6303f491.js"><link rel="prefetch" href="/assets/js/15.e60734ed.js"><link rel="prefetch" href="/assets/js/16.6c3d6e47.js"><link rel="prefetch" href="/assets/js/17.e030f553.js"><link rel="prefetch" href="/assets/js/18.21cf0a91.js"><link rel="prefetch" href="/assets/js/19.8d5755fa.js"><link rel="prefetch" href="/assets/js/20.2cd2b36d.js"><link rel="prefetch" href="/assets/js/3.57a83492.js"><link rel="prefetch" href="/assets/js/4.781d444d.js"><link rel="prefetch" href="/assets/js/5.17835e32.js"><link rel="prefetch" href="/assets/js/6.32c9912a.js"><link rel="prefetch" href="/assets/js/7.5ec046d3.js"><link rel="prefetch" href="/assets/js/8.a9b097fa.js"><link rel="prefetch" href="/assets/js/9.de9b2c16.js">
    <link rel="stylesheet" href="/assets/css/0.styles.978437f2.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">庞希</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  主页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="开源框架" class="dropdown-title"><span class="title">开源框架</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/framework/vuepress.html" class="nav-link">
  VuePress
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="开发工具" class="dropdown-title"><span class="title">开发工具</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/tools/vscode.html" class="nav-link">
  VSCode
</a></li><li class="dropdown-item"><!----> <a href="/tools/git.html" class="nav-link">
  Git
</a></li><li class="dropdown-item"><!----> <a href="/tools/yarn.html" class="nav-link">
  Yarn
</a></li><li class="dropdown-item"><!----> <a href="/tools/nodejs.html" class="nav-link">
  Nodejs
</a></li><li class="dropdown-item"><!----> <a href="/tools/tuchuang.html" class="nav-link">
  图床
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="其他文章" class="dropdown-title"><span class="title">其他文章</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/another/mozilla.html" class="nav-link">
  Mozilla
</a></li><li class="dropdown-item"><!----> <a href="/another/cad.html" class="nav-link">
  Cad
</a></li></ul></div></div><div class="nav-item"><a href="/study_1/" class="nav-link">
  学习笔记
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  主页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="开源框架" class="dropdown-title"><span class="title">开源框架</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/framework/vuepress.html" class="nav-link">
  VuePress
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="开发工具" class="dropdown-title"><span class="title">开发工具</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/tools/vscode.html" class="nav-link">
  VSCode
</a></li><li class="dropdown-item"><!----> <a href="/tools/git.html" class="nav-link">
  Git
</a></li><li class="dropdown-item"><!----> <a href="/tools/yarn.html" class="nav-link">
  Yarn
</a></li><li class="dropdown-item"><!----> <a href="/tools/nodejs.html" class="nav-link">
  Nodejs
</a></li><li class="dropdown-item"><!----> <a href="/tools/tuchuang.html" class="nav-link">
  图床
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="其他文章" class="dropdown-title"><span class="title">其他文章</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/another/mozilla.html" class="nav-link">
  Mozilla
</a></li><li class="dropdown-item"><!----> <a href="/another/cad.html" class="nav-link">
  Cad
</a></li></ul></div></div><div class="nav-item"><a href="/study_1/" class="nav-link">
  学习笔记
</a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/study_2/ccpp/c.html" class="active sidebar-link">C Primer Plus</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/study_2/ccpp/c.html#ch3-数据和c" class="sidebar-link">Ch3 数据和C</a></li><li class="sidebar-sub-header"><a href="/study_2/ccpp/c.html#ch4-字符串和格式化输入-输出" class="sidebar-link">Ch4 字符串和格式化输入/输出</a></li><li class="sidebar-sub-header"><a href="/study_2/ccpp/c.html#ch5-运算符、表达式和语句" class="sidebar-link">Ch5 运算符、表达式和语句</a></li><li class="sidebar-sub-header"><a href="/study_2/ccpp/c.html#ch6-c控制语句：循环" class="sidebar-link">Ch6 C控制语句：循环</a></li><li class="sidebar-sub-header"><a href="/study_2/ccpp/c.html#ch7-c控制语句：分支和跳转" class="sidebar-link">Ch7 C控制语句：分支和跳转</a></li><li class="sidebar-sub-header"><a href="/study_2/ccpp/c.html#ch8-字符输入-输出和输入验证" class="sidebar-link">Ch8 字符输入/输出和输入验证</a></li><li class="sidebar-sub-header"><a href="/study_2/ccpp/c.html#ch9-函数" class="sidebar-link">Ch9 函数</a></li><li class="sidebar-sub-header"><a href="/study_2/ccpp/c.html#ch10-数组与指针" class="sidebar-link">Ch10 数组与指针</a></li><li class="sidebar-sub-header"><a href="/study_2/ccpp/c.html#ch11-字符串和字符串函数" class="sidebar-link">Ch11 字符串和字符串函数</a></li><li class="sidebar-sub-header"><a href="/study_2/ccpp/c.html#ch12-存储类别、链接和内存管理" class="sidebar-link">Ch12 存储类别、链接和内存管理</a></li><li class="sidebar-sub-header"><a href="/study_2/ccpp/c.html#ch13-文件输入-输出" class="sidebar-link">Ch13 文件输入/输出</a></li><li class="sidebar-sub-header"><a href="/study_2/ccpp/c.html#ch14-结构和其他数据形式" class="sidebar-link">Ch14 结构和其他数据形式</a></li><li class="sidebar-sub-header"><a href="/study_2/ccpp/c.html#ch15-位操作" class="sidebar-link">Ch15 位操作</a></li></ul></li><li><a href="/study_2/ccpp/cexercises.html" class="sidebar-link">C Exercises</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="ch3-数据和c"><a href="#ch3-数据和c" class="header-anchor">#</a> Ch3 数据和C</h2> <h3 id="数据类型关键字"><a href="#数据类型关键字" class="header-anchor">#</a> 数据类型关键字</h3> <table><thead><tr><th style="text-align:left;">K&amp;R 标准给出关键字</th> <th style="text-align:left;">C90 标准添加关键字</th> <th style="text-align:left;">C99 标准添加关键字</th></tr></thead> <tbody><tr><td style="text-align:left;">int</td> <td style="text-align:left;">signed</td> <td style="text-align:left;">_Bool</td></tr> <tr><td style="text-align:left;">long</td> <td style="text-align:left;">void</td> <td style="text-align:left;">_Comlex</td></tr> <tr><td style="text-align:left;">short</td> <td style="text-align:left;"></td> <td style="text-align:left;">_Imaginary</td></tr> <tr><td style="text-align:left;">unsigned</td> <td style="text-align:left;"></td> <td style="text-align:left;"></td></tr> <tr><td style="text-align:left;">char</td> <td style="text-align:left;"></td> <td style="text-align:left;"></td></tr> <tr><td style="text-align:left;">float</td> <td style="text-align:left;"></td> <td style="text-align:left;"></td></tr> <tr><td style="text-align:left;">double</td> <td style="text-align:left;"></td> <td style="text-align:left;"></td></tr></tbody></table> <h3 id="八进制和十六进制（使用与显示）"><a href="#八进制和十六进制（使用与显示）" class="header-anchor">#</a> 八进制和十六进制（使用与显示）</h3> <p>使用 <code>0</code> 前缀表示八进制</p> <p>使用 <code>0x</code> 或 <code>0X</code> 前缀表示十六进制</p> <p><code>%o</code> 以八进制显示 -- <code>%#o</code> 带上前缀显示</p> <p><code>%x</code> 以十六进制显示 -- <code>%#x</code> 带上前缀显示</p> <h3 id="其他整数类型"><a href="#其他整数类型" class="header-anchor">#</a> 其他整数类型</h3> <p>short int (简写 <code>short</code> ) 占的存储空间可能比int少，用于较小数值场合来节省空间</p> <p>long int (简写 <code>long</code> ) 占的空间比int多，较大数值</p> <p>long long int (简写 <code>long long</code> ) 占的空间比long 多， 更大数值</p> <p>unsigned int (简写 <code>unsigned</code> ) 非负数</p> <p>在有符号类型前面加关键字 <code>signed</code>，可强调这个类型是有符号类型（可正可负）</p> <ul><li>个人PC上最常见的设置</li></ul> <table><thead><tr><th style="text-align:left;">类型</th> <th style="text-align:left;">占用字节</th> <th style="text-align:left;">存储单元</th></tr></thead> <tbody><tr><td style="text-align:left;">short</td> <td style="text-align:left;">2 bytes</td> <td style="text-align:left;">16</td></tr> <tr><td style="text-align:left;">int</td> <td style="text-align:left;">4 bytes</td> <td style="text-align:left;">32</td></tr> <tr><td style="text-align:left;">long</td> <td style="text-align:left;">4 bytes</td> <td style="text-align:left;">32</td></tr> <tr><td style="text-align:left;">long long</td> <td style="text-align:left;">8 bytes</td> <td style="text-align:left;">64</td></tr></tbody></table> <ul><li>后缀说明</li></ul> <p>在数字后加L：12L，意味着将把12看作是 <code>long</code> 型数据</p> <p>在数字后加LL：3LL，意味着将把3看作是 <code>long long</code> 型数据</p> <p>在数字后加U：5ULL，意味着将把12看作是 <code>unsigned long long</code> 型数据</p> <div class="custom-block warning"><p class="custom-block-title">可小写/大写，小写 l 与数字 1 相似，所以习惯统一大写</p></div> <ul><li>整数溢出</li></ul> <p>当数字范围大于数据类型范围时，会产生溢出。溢出时，将回到最小值。</p> <div class="custom-block warning"><p class="custom-block-title">int的最大表示值是2147483647当你再对这个数加1时，就会溢出，回到最小值 -2147483648</p></div> <h3 id="char字符"><a href="#char字符" class="header-anchor">#</a> char字符</h3> <ol><li>从技术层面看，char是整型类型，存储的是整型而不是字符</li> <li>标准<code>ASCII</code> 码的范围是 0~127 只需 7 位二进制数，char类型被定义 8 位存储单元，容纳标准 <code>ASCII</code> 码搓搓有余</li> <li>定义字符常量 'FATE'，自由最后 8 位有效，因此变量的值为 'E'</li> <li>转义序列</li></ol> <table><thead><tr><th style="text-align:left;">转义序列</th> <th style="text-align:left;">含义</th> <th style="text-align:left;">转义序列</th> <th style="text-align:left;">含义</th></tr></thead> <tbody><tr><td style="text-align:left;">\a</td> <td style="text-align:left;">警报（ANSI C）</td> <td style="text-align:left;">\\</td> <td style="text-align:left;">反斜杠（）</td></tr> <tr><td style="text-align:left;">\b</td> <td style="text-align:left;">退格</td> <td style="text-align:left;">\'</td> <td style="text-align:left;">单引号</td></tr> <tr><td style="text-align:left;">\f</td> <td style="text-align:left;">换页</td> <td style="text-align:left;">\''</td> <td style="text-align:left;">双引号</td></tr> <tr><td style="text-align:left;">\n</td> <td style="text-align:left;">换行</td> <td style="text-align:left;">?</td> <td style="text-align:left;">问号</td></tr> <tr><td style="text-align:left;">\r</td> <td style="text-align:left;">回车</td> <td style="text-align:left;">\0oo</td> <td style="text-align:left;">八进制值，0为0~7</td></tr> <tr><td style="text-align:left;">\t</td> <td style="text-align:left;">水平制表符</td> <td style="text-align:left;">\0hh</td> <td style="text-align:left;">十六进制值，h为0~f</td></tr> <tr><td style="text-align:left;">\v</td> <td style="text-align:left;">垂直制表符</td> <td style="text-align:left;"></td> <td style="text-align:left;"></td></tr></tbody></table> <h3 id="float、double和long-double"><a href="#float、double和long-double" class="header-anchor">#</a> float、double和long double</h3> <ul><li><code>float</code> 类型必须至少能表示 6 位有效数字，系统存储占用 32 位</li> <li><code>double</code> 类型必须至少能表示 10 位有效数字，系统存储占用 64 位</li> <li><code>long double</code> 类型至少与 <code>double</code> 类型精度相同</li></ul> <h3 id="复数和虚数类型"><a href="#复数和虚数类型" class="header-anchor">#</a> 复数和虚数类型</h3> <ul><li>3种复数类型：<code>float_Complex</code>、 <code>double_Complex</code>、<code>long double_Complex</code></li> <li>3种虚数类型：<code>float_Imaginary</code>、<code>double_Imaginary</code>、<code>long double_Imaginary</code></li></ul> <div class="custom-block warning"><p class="custom-block-title">float_Complex 类型的变量应包含两个 float 类型的值，复数的实部和虚部</p></div> <h3 id="sizeof类型大小"><a href="#sizeof类型大小" class="header-anchor">#</a> sizeof类型大小</h3> <p><code>sizeof()</code> 以字节（bytes）给出指定类型大小，C99 和 C11 提供 <code>%zd</code> 转换说明</p> <div class="custom-block warning"><p class="custom-block-title">一些不支持 C99 和 C11 的编译器可用 %u 或 %lu</p></div> <h3 id="缓冲区（buffer）"><a href="#缓冲区（buffer）" class="header-anchor">#</a> 缓冲区（buffer）</h3> <p><code>printf()</code> 什么时候把输出发送到屏幕上？</p> <p>开始 <code>printf()</code> 发生内容到 缓冲区 ，然后缓冲区的内容再发送到屏幕上，</p> <p>缓冲区满/换行/输入 时，缓冲区的数据发送到屏幕或文件上。称为 刷新缓冲区</p> <h3 id="additional"><a href="#additional" class="header-anchor">#</a> Additional</h3> <ol><li>水平制表符按 8 位跳</li></ol> <h2 id="ch4-字符串和格式化输入-输出"><a href="#ch4-字符串和格式化输入-输出" class="header-anchor">#</a> Ch4 字符串和格式化输入/输出</h2> <h3 id="char类型数组和null字符"><a href="#char类型数组和null字符" class="header-anchor">#</a> char类型数组和null字符</h3> <ul><li><p>C语言没有专门存储字符串的变量类型，字符串存储在 <code>char</code> 类型数组中</p></li> <li><p>在数组末尾有一个空字符（null character）<code>\0</code> 标记字符串结束</p></li></ul> <h3 id="使用字符串"><a href="#使用字符串" class="header-anchor">#</a> 使用字符串</h3> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">char</span> name<span class="token punctuation">[</span><span class="token number">40</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">&quot;%s&quot;</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;Hello, %s\n&quot;</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="custom-block warning"><p class="custom-block-title">只有一个字符的字符串和字符不同: 'x' 和 &quot;x&quot; ，单引号的是字符；双引号的是字符串，实际上是两个字符 x 和 \0 组成</p></div> <h3 id="常量和c预处理器"><a href="#常量和c预处理器" class="header-anchor">#</a> 常量和C预处理器</h3> <ul><li><code>define</code> 定义常量 / 别名：明示常量</li></ul> <div class="language-c extra-class"><pre class="language-c"><code><span class="token comment">/* 
1. 符号常量不占用内存
2. 不能对符号常量赋值
3. 习惯上符号常量用大写表示
4. 无等号，无分号
*/</span>
<span class="token macro property">#<span class="token directive keyword">define</span> NAME value</span>
<span class="token macro property">#<span class="token directive keyword">define</span> PI 3.1415</span>
</code></pre></div><h3 id="const限定符"><a href="#const限定符" class="header-anchor">#</a> const限定符</h3> <ul><li>C90 标准新增 <code>const</code> 关键字 : 限定一个变量为只读</li></ul> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">const</span> <span class="token keyword">int</span> MONTHS <span class="token operator">=</span> <span class="token number">12</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="明示常量"><a href="#明示常量" class="header-anchor">#</a> 明示常量</h3> <div class="custom-block warning"><p class="custom-block-title">C头文件 limits.h 和 float.h 提供了整数类型和浮点数类型大小限制相关信息</p></div> <h3 id="printf-和scanf"><a href="#printf-和scanf" class="header-anchor">#</a> printf()和scanf()</h3> <ul><li>printf() 打印长字符的3种方式</li></ul> <div class="language-c extra-class"><pre class="language-c"><code><span class="token comment">/*
格式 -- printf(格式字符串，待打印项1,待打印项2,...);
1. 实际打印
2. 转换说明
*/</span>

    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;Here's one way to print a &quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;long string.\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;Here's another way to print a \
long string.\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;Here's the newest way to print a &quot;</span>
            <span class="token string">&quot;long string.\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">/* ANSI C */</span>
</code></pre></div><div class="custom-block warning"><p class="custom-block-title">printf() 它返回打印的字符数，如果输出错误，则返回负数</p></div> <ul><li>scanf()</li></ul> <div class="language-c extra-class"><pre class="language-c"><code><span class="token comment">/*
格式 -- scanf(&quot;%d%d&quot;,&amp;a,&amp;b);
1. 用 scanf() 读取基本变量类型的值，在变量明前加上一个 &amp;
2. 用 scanf() 把字符串读入字符数组中，不用使用 &amp;
3. scanf() 使用 空白 把输入分成多个字段
*/</span>

    <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">&quot;%d%d&quot;</span><span class="token punctuation">,</span><span class="token operator">&amp;</span>a<span class="token punctuation">,</span><span class="token operator">&amp;</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="custom-block warning"><p class="custom-block-title">scanf() 返回值是成功读取的项数，读入失败时返回0；对文件读写来说，读到文件末尾返回EOF = -1</p></div> <h3 id="修饰符"><a href="#修饰符" class="header-anchor">#</a> *修饰符</h3> <ul><li>printf() *修饰符：指定宽度和精度</li></ul> <div class="language-c extra-class"><pre class="language-c"><code><span class="token comment">/*

*/</span>
    <span class="token keyword">unsigned</span> width<span class="token punctuation">,</span> precision<span class="token punctuation">;</span>
    <span class="token keyword">int</span> numberf <span class="token operator">=</span> <span class="token number">256</span><span class="token punctuation">;</span>
    <span class="token keyword">double</span> weight <span class="token operator">=</span> <span class="token number">242.5</span><span class="token punctuation">;</span>
    <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">&quot;%d&quot;</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>width<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;number = %*d\n&quot;</span><span class="token punctuation">,</span> width<span class="token punctuation">,</span> number<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//--指定宽度</span>
    <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">&quot;%d%d&quot;</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>width<span class="token punctuation">,</span> <span class="token operator">&amp;</span>precision<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;weight = %*.*f\n&quot;</span><span class="token punctuation">,</span> width<span class="token punctuation">,</span> precision<span class="token punctuation">,</span> weight<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//--指定宽度和精度</span>
</code></pre></div><ul><li>scanf() *修饰符：跳过输入中的整数</li></ul> <div class="language-c extra-class"><pre class="language-c"><code>    <span class="token keyword">int</span> n<span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;Please enter three integers:\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">&quot;%*d %*d %d, &amp;n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//--跳过两个整数，把第3个整数拷贝给n</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;The last integer was %d\n, n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="additional-2"><a href="#additional-2" class="header-anchor">#</a> Additional</h3> <ol><li>strlen()函数</li></ol> <h2 id="ch5-运算符、表达式和语句"><a href="#ch5-运算符、表达式和语句" class="header-anchor">#</a> Ch5 运算符、表达式和语句</h2> <h3 id="基本运算符和优先级"><a href="#基本运算符和优先级" class="header-anchor">#</a> 基本运算符和优先级</h3> <p><img src="https://gxkjsfxy.oss-cn-shenzhen.aliyuncs.com/gg/%E8%BF%90%E7%AE%97%E7%AC%A6.jpg" alt="img"></p> <ol><li>优先级高的先算，(优先级)相同的按照结合律</li> <li>由于()优先级最高，我们只要把想先计算的用() 括起来就行了。</li></ol> <h3 id="其他运算符"><a href="#其他运算符" class="header-anchor">#</a> 其他运算符</h3> <ul><li>sizeof 运算符和 size_t 类型</li></ul> <p>简述: <code>size_t</code> 是一个无符号整数类型，是用 <code>typedef</code> 给无符号整数起的别名</p> <p>格式: <code>sizeof</code> 返回值是一个 <code>size_t</code> 类型值，用 <code>%zd</code> 或 <code>%u</code> 显示 <code>size_t</code> 类型值</p> <p>作用: 以字节 <code>bytes</code> 为单位返回运算对象的大小</p> <p>用法: <code>sizeof(int)</code> <code>sizeof n</code>，类型必须加()、变量()可以不加</p> <ul><li>%求模运算符</li></ul> <p>作用: 只能用于整数运算，左边除以右边的余数</p> <blockquote><p>13 % 5 = 3</p> <p>20 % 3 = 2</p></blockquote> <h3 id="几个术语"><a href="#几个术语" class="header-anchor">#</a> 几个术语</h3> <table><thead><tr><th style="text-align:left;"></th> <th style="text-align:left;"></th></tr></thead> <tbody><tr><td style="text-align:left;">数据对象(data object):</td> <td style="text-align:left;">用于储存值的数据存储区域</td></tr> <tr><td style="text-align:left;">左值(lvalue)</td> <td style="text-align:left;">用于标识和定位存储位置的标签</td></tr> <tr><td style="text-align:left;">右值(rvalue)</td> <td style="text-align:left;">能赋值给可修改左值的量</td></tr></tbody></table> <h3 id="表达式"><a href="#表达式" class="header-anchor">#</a> 表达式</h3> <p>简述: 表达式 (<em>expression</em>) 由 运算符 和 运算对象 组成。</p> <table><thead><tr><th style="text-align:left;">表达式</th> <th style="text-align:left;">值</th> <th style="text-align:left;"></th> <th style="text-align:left;">表达式</th> <th style="text-align:left;">值</th></tr></thead> <tbody><tr><td style="text-align:left;">-4 + 6</td> <td style="text-align:left;">2</td> <td style="text-align:left;"></td> <td style="text-align:left;">5 &gt; 3</td> <td style="text-align:left;">1</td></tr> <tr><td style="text-align:left;">c = 3 + 8</td> <td style="text-align:left;">11</td> <td style="text-align:left;"></td> <td style="text-align:left;">6 + (c = 3 + 8)</td> <td style="text-align:left;">17</td></tr></tbody></table> <div class="custom-block warning"><p class="custom-block-title">每个表达式都有一个值</p></div> <h3 id="语句"><a href="#语句" class="header-anchor">#</a> 语句</h3> <ul><li>语句 (<em>statement</em>)</li></ul> <p>简述: 语句是 C 程序的基本构建模块，大多数语句都以 <code>;</code> 结尾</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h&gt;</span></span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">int</span> count<span class="token punctuation">,</span> num<span class="token punctuation">;</span>             <span class="token comment">/* 声明不是语句 */</span>
    <span class="token punctuation">;</span>                           <span class="token comment">/* 空语句       */</span>
    count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>                  <span class="token comment">/* 表达式语句   */</span>
    num <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>                    <span class="token comment">/* 表达式语句   */</span>

    <span class="token keyword">while</span> <span class="token punctuation">(</span>count<span class="token operator">++</span> <span class="token operator">&lt;</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">{</span>       <span class="token comment">/* 迭代语句     */</span>
        sum <span class="token operator">=</span> sum <span class="token operator">+</span> count<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;sum = %d\n&quot;</span><span class="token punctuation">,</span> sum<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">/* 表达式语句   */</span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>                   <span class="token comment">/* 跳转语句     */</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>副作用 (<em>side effect</em>)</li></ul> <p>简述: 副作用是对数据对象或文件的修改。</p> <div class="language-c extra-class"><pre class="language-c"><code>states <span class="token operator">=</span> <span class="token number">50</span><span class="token punctuation">;</span> <span class="token comment">//副作用是让state的值为 50</span>
<span class="token comment">/*
从C语言的角度看，主要目的是对表达式求值，
而赋值表达式的副作用是让变量的值改变。
*/</span>
</code></pre></div><ul><li>序列点 (<em>sequence point</em>)</li></ul> <p>简述: 序列点是程序执行的点，在该点上，所有副作用都在进入下一步之前发生。</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token comment">/*
在 C 语言中，分号标记一个序列点；
一个完整表达式的结束也是一个序列点；
完整表达式(full expression) 指的是这个表达式，不是另一个表达式的子表达式。
*/</span>
</code></pre></div><h3 id="复合语句（块）"><a href="#复合语句（块）" class="header-anchor">#</a> 复合语句（块）</h3> <p>简述: 复合语句块是花括号 <code>{</code> <code>}</code> 括起来的多条语句</p> <p>① 风格突出了块附属于 while 循环</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">while</span> <span class="token punctuation">(</span>index<span class="token operator">++</span> <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    sam <span class="token operator">=</span> <span class="token number">10</span><span class="token operator">*</span>index <span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;sam = %d \n&quot;</span><span class="token punctuation">,</span> sam<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>② 风格强调语句形成一个块</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">while</span> <span class="token punctuation">(</span>index<span class="token operator">++</span> <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    sam <span class="token operator">=</span> <span class="token number">10</span><span class="token operator">*</span>index <span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;sam = %d \n&quot;</span><span class="token punctuation">,</span> sam<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="类型转换"><a href="#类型转换" class="header-anchor">#</a> 类型转换</h3> <ul><li><p>当类型不匹配时，C语言会自动进行基本的类型转换。</p></li> <li><p>强制类型转换</p></li></ul> <p>使用强制类型转换符: (type)value</p> <div class="language-c extra-class"><pre class="language-c"><code>    <span class="token keyword">int</span> conversion_1<span class="token punctuation">,</span> conversion_2<span class="token punctuation">;</span>
    conversion_1 <span class="token operator">=</span> <span class="token number">1.6</span> <span class="token operator">+</span> <span class="token number">1.7</span><span class="token punctuation">;</span>           <span class="token comment">/* 先运算，再转换截断后值为 3 */</span>
    conversion_2 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token number">1.6</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token number">1.7</span><span class="token punctuation">;</span> <span class="token comment">/* 先截断为 1，再运算后值为 2 */</span>
</code></pre></div><h3 id="additional-3"><a href="#additional-3" class="header-anchor">#</a> Additional</h3> <ol><li>带参数的函数</li></ol> <ul><li>函数没有返回值，函数名前加关键字 <code>void</code></li> <li>函数不接受任何参数，函数头的圆括号中应该写上关键字 <code>void</code></li></ul> <h2 id="ch6-c控制语句：循环"><a href="#ch6-c控制语句：循环" class="header-anchor">#</a> Ch6 C控制语句：循环</h2> <h3 id="c风格读取循环"><a href="#c风格读取循环" class="header-anchor">#</a> C风格读取循环</h3> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">&quot;%ld&quot;</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>num<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">{</span>

<span class="token comment">/* 循环行为 */</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="while语句"><a href="#while语句" class="header-anchor">#</a> while语句</h3> <ol><li>通用形式</li></ol> <div class="language-c extra-class"><pre class="language-c"><code>    <span class="token keyword">while</span> <span class="token punctuation">(</span>expression<span class="token punctuation">)</span>
        statement
</code></pre></div><ol start="2"><li><p>构建 <code>while</code> 循环，必须让测试表达式值有变化，表达式最终要为假。（除去<code>break</code>、<code>if</code>）</p></li> <li><p>如 (index &lt; 5) 表达式是一个 入口条件(<em>entry condition</em>)，必须满足才进入循环体</p></li> <li><p>语法要点</p></li></ol> <ul><li>只有测试条件后面的单独语句（简单语句 or 复合语句 or 空语句）才是循环部分</li></ul> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">int</span> n <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">while</span> <span class="token punctuation">(</span>n <span class="token operator">&lt;</span> <span class="token number">3</span><span class="token punctuation">)</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;n is %d\n&quot;</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>
    n<span class="token operator">++</span><span class="token punctuation">;</span>  <span class="token comment">//这句不是循环体的内容，n++不会执行，n&lt;3一直成立，所以为死循环</span>
</code></pre></div><div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">while</span><span class="token punctuation">(</span> <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">&quot;%d&quot;</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>num<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token punctuation">;</span>  <span class="token comment">/* 跳过整数输入 */</span>
</code></pre></div><h3 id="用关系运算符和表达式比较大小"><a href="#用关系运算符和表达式比较大小" class="header-anchor">#</a> 用关系运算符和表达式比较大小</h3> <ol><li>关系运算符</li></ol> <table><thead><tr><th style="text-align:left;">运算符</th> <th style="text-align:left;">含义</th> <th style="text-align:left;">运算符</th> <th style="text-align:left;">含义</th></tr></thead> <tbody><tr><td style="text-align:left;">&lt;</td> <td style="text-align:left;">小于</td> <td style="text-align:left;">&gt;</td> <td style="text-align:left;">大于</td></tr> <tr><td style="text-align:left;">&lt;=</td> <td style="text-align:left;">小于或等于</td> <td style="text-align:left;">&gt;=</td> <td style="text-align:left;">大于或等于</td></tr> <tr><td style="text-align:left;">==</td> <td style="text-align:left;">等于</td> <td style="text-align:left;">!=</td> <td style="text-align:left;">不等于</td></tr></tbody></table> <ol start="2"><li>什么是真，什么是假</li></ol> <ul><li>简言之，1是真，0是假；非0为真值</li></ul> <ol start="3"><li>真值的问题</li></ol> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">int</span> status<span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>status <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    	sum <span class="token operator">+=</span> num<span class="token punctuation">;</span>
    	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;Enter next integer (q to quit):&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    	status <span class="token operator">=</span> <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">&quot;%ld&quot;</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>num<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre></div><ul><li><p>本来这段代码是要在按下 <code>q</code> 的时候退出循环的，但是由于将 <code>status == 1</code> 错写成 <code>status = 1</code>，结果 <code>while</code> 后面的表达式变成了一个赋值表达式，而这个赋值表达式的值是 <code>=</code> 左侧的值，即 <code>status</code> 的值，即 <code>1</code>。即使进入循环体时输入 <code>q</code> 使得 <code>status</code> 的值变为 <code>0</code>，进入 <code>while</code> 判断时又会执行一次 <code>status = 1</code>，结果无法退出循环。</p></li> <li><p>避免这种错误的一个方法，是将 常数 写在 <code>==</code> 左侧，例(1 == status)，这样如果漏写一个 <code>=</code> ，写成1 = status的话，编译器就会报错。</p></li></ul> <ol start="4"><li>新的_Bool类型</li></ol> <ul><li>C99中的新变量类型 布尔类型<code>_Bool</code>，只有真（1）或假（0）两种值</li></ul> <ol start="5"><li>优先级和关系运算符</li></ol> <ul><li><code>(</code> <code>)</code>优先级最高，使用<code>(</code> <code>)</code>就可以。没必要写一些可读性很差、很长的表达式</li></ul> <h3 id="for循环"><a href="#for循环" class="header-anchor">#</a> for循环</h3> <ol><li>形式</li></ol> <div class="language-c extra-class"><pre class="language-c"><code>    <span class="token keyword">for</span> <span class="token punctuation">(</span>initialize<span class="token punctuation">;</span> test<span class="token punctuation">;</span> update<span class="token punctuation">)</span>
        statement
</code></pre></div><ol start="2"><li>利用for的灵活性</li></ol> <div class="language-c extra-class"><pre class="language-c"><code><span class="token comment">/* 
第 1 个表达式给计数器赋初值
第 2 个表达式表示计数器的范围
第 3 个表达式递增计数器
*/</span>

<span class="token comment">/* 可以使用递减运算符来递减计数器 */</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>secs <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span> secs <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">;</span> secs<span class="token operator">--</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        statement
    <span class="token punctuation">}</span>
<span class="token comment">/* 可以让计数器递增2/10等 */</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>n <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span> n <span class="token operator">&lt;</span> <span class="token number">60</span><span class="token punctuation">;</span> n <span class="token operator">=</span> n <span class="token operator">+</span> <span class="token number">13</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        statement
    <span class="token punctuation">}</span>
<span class="token comment">/* 可以用字符代替数字计数 */</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>ch <span class="token operator">=</span> <span class="token string">'a'</span><span class="token punctuation">;</span> ch <span class="token operator">&lt;=</span> 'z<span class="token punctuation">;</span> ch<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        statement
    <span class="token punctuation">}</span>
<span class="token comment">/* 可以测试迭代次数，还可以测试其他，例如限制立方的大小 */</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>num <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> num<span class="token operator">*</span>num<span class="token operator">*</span>num <span class="token operator">&lt;=</span> <span class="token number">216</span><span class="token punctuation">;</span> num<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        statement
    <span class="token punctuation">}</span>
<span class="token comment">/* 可以让递增的量几何增长，而不是算术增长 */</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>debt <span class="token operator">=</span> <span class="token number">100.0</span><span class="token punctuation">;</span> debt <span class="token operator">&lt;</span> <span class="token number">150.0</span><span class="token punctuation">;</span> debt <span class="token operator">=</span> debt <span class="token operator">*</span> <span class="token number">1.1</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        statement
    <span class="token punctuation">}</span>
<span class="token comment">/* 第 3 个表达式可以使用任意合法的表达式 */</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>x <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> y <span class="token operator">&lt;=</span> <span class="token number">75</span><span class="token punctuation">;</span> y <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token operator">++</span>x <span class="token operator">*</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        statement
    <span class="token punctuation">}</span>
<span class="token comment">/* 可以省略一个或多个表达式，省略第 2 个表达式被视为真 */</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>n <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span> ans <span class="token operator">&lt;=</span> <span class="token number">25</span><span class="token punctuation">;</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        ans <span class="token operator">=</span> ans <span class="token operator">*</span> n<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token comment">/* 执行循环的其他部分之前，只对第 1 个表达式执行一次 */</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;Keep entering numbers!\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> num <span class="token operator">!=</span> <span class="token number">6</span><span class="token punctuation">;</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        statement
    <span class="token punctuation">}</span>
<span class="token comment">/* 循环体中的行为可以改变循环头中的表达式 */</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>n <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> n <span class="token operator">&lt;</span> <span class="token number">10000</span><span class="token punctuation">;</span> n <span class="token operator">=</span> n <span class="token operator">+</span> delta<span class="token punctuation">)</span><span class="token punctuation">{</span>
        statement
    <span class="token punctuation">}</span>
</code></pre></div><h3 id="逗号运算符"><a href="#逗号运算符" class="header-anchor">#</a> 逗号运算符</h3> <ol><li>逗号运算符 <code>,</code> 扩展了 <code>for</code> 循环的灵活性，以便循环头中包含更多的表达式，如：</li></ol> <div class="language-c extra-class"><pre class="language-c"><code>    <span class="token keyword">for</span> <span class="token punctuation">(</span>ounces <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> cost <span class="token operator">=</span> FIRSsT_OZ<span class="token punctuation">;</span> ounces <span class="token operator">&lt;=</span> <span class="token number">16</span><span class="token punctuation">;</span> ounces<span class="token operator">++</span><span class="token punctuation">,</span> cost <span class="token operator">+=</span> NEXT_OZ<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;%5d $%4.2f\n&quot;</span><span class="token punctuation">,</span> ounces<span class="token punctuation">,</span> cost<span class="token operator">/</span><span class="token number">100.0</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre></div><ol start="2"><li>逗号运算符 <code>,</code> 有两个其他性质</li></ol> <ul><li>首先，它保证了被它分隔的表达式从左往右求值</li> <li>其次，整个逗号表达式的值是右侧项的值</li> <li>注意: 下面的逗号是分隔符，不是逗号运算符</li></ul> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">char</span> ch<span class="token punctuation">,</span> date<span class="token punctuation">;</span>
<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;%d %d\n&quot;</span><span class="token punctuation">,</span> chimps<span class="token punctuation">,</span> chumps<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="出口条件循环：do-while"><a href="#出口条件循环：do-while" class="header-anchor">#</a> 出口条件循环：do while</h3> <ol><li>形式</li></ol> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">do</span>
    statement
<span class="token keyword">while</span> <span class="token punctuation">(</span>expression<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><code>do while</code> 语句是一种出口条件循环，即在执行完循环体后才根据测试条件决定是否再次执行循环</p> <h3 id="嵌套循环and嵌套变式"><a href="#嵌套循环and嵌套变式" class="header-anchor">#</a> 嵌套循环and嵌套变式</h3> <ol><li>嵌套循环</li></ol> <div class="language-c extra-class"><pre class="language-c"><code><span class="token comment">/* 
循环内的语句也是循环时，就形成嵌套循环，以简单的二层嵌套为例
外层循环每执行一次，里面的语句就执行一遍（包括循环）
注意，嵌套循环中的内层循环在每次外层循环迭代时都执行完所有的循环
*/</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>row <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> row <span class="token operator">&lt;</span> <span class="token number">5</span><span class="token punctuation">;</span> row<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span>ch <span class="token operator">=</span> <span class="token string">'A'</span><span class="token punctuation">;</span> ch <span class="token operator">&lt;</span> <span class="token string">'A'</span><span class="token operator">+</span><span class="token number">10</span><span class="token punctuation">;</span> ch<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;%c&quot;</span><span class="token punctuation">,</span> ch<span class="token punctuation">)</span><span class="token punctuation">;</span>
    	<span class="token punctuation">}</span>
    		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre></div><div class="language-sh extra-class"><pre class="language-sh"><code>ABCDEFGHIJ
ABCDEFGHIJ
ABCDEFGHIJ
<span class="token punctuation">..</span>.
</code></pre></div><ol start="2"><li>嵌套变式</li></ol> <div class="language-c extra-class"><pre class="language-c"><code>    <span class="token keyword">const</span> <span class="token keyword">int</span> ROWS <span class="token operator">=</span> <span class="token number">6</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> <span class="token keyword">int</span> CHARS <span class="token operator">=</span> <span class="token number">6</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> row<span class="token punctuation">;</span>
    <span class="token keyword">char</span> ch<span class="token punctuation">;</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span>row <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> row <span class="token operator">&lt;</span> ROWS<span class="token punctuation">;</span> row<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span>ch <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">'A'</span> <span class="token operator">+</span> row<span class="token punctuation">;</span> ch <span class="token operator">&lt;</span> <span class="token punctuation">(</span><span class="token string">'A'</span> <span class="token operator">+</span> CHARS<span class="token punctuation">)</span><span class="token punctuation">;</span> ch<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;%c&quot;</span><span class="token punctuation">,</span> ch<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;\n&quot;</span><span class="token punctuation">,</span> ch<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre></div><div class="language-sh extra-class"><pre class="language-sh"><code>ABCDEF
BCDEF
CDEF
DEF
EF
F
<span class="token punctuation">..</span>.
</code></pre></div><h3 id="additional-4"><a href="#additional-4" class="header-anchor">#</a> Additional</h3> <ol><li>阶乘</li></ol> <ul><li><p><code>unsigned long long</code> 可以显示 1~20 阶层总和，使用 <code>%llu</code> 格式打印</p></li> <li><p>关键是 n! = n x (n-1)!</p></li> <li><p>3 的阶乘（写作3!）是 1x2x3。另外，0! 等于 1，负数没有阶乘</p></li></ul> <ol start="2"><li><p>如何选择循环：出口循环选 <code>do while</code>，入口循环 <code>for</code> 或 <code>while</code></p></li> <li><p>数组简介</p></li> <li><p>使用函数返回值的循环示例</p></li></ol> <h2 id="ch7-c控制语句：分支和跳转"><a href="#ch7-c控制语句：分支和跳转" class="header-anchor">#</a> Ch7 C控制语句：分支和跳转</h2> <p>使用分支结构 （if、switch）让程序根据测试条件执行相应的行为。</p> <h3 id="if语句"><a href="#if语句" class="header-anchor">#</a> if语句</h3> <ol><li>if语句</li></ol> <div class="language-c extra-class"><pre class="language-c"><code>    <span class="token keyword">if</span> <span class="token punctuation">(</span>expression<span class="token punctuation">)</span>
        statement
</code></pre></div><ol start="2"><li>if else语句</li></ol> <div class="language-c extra-class"><pre class="language-c"><code>    <span class="token keyword">if</span> <span class="token punctuation">(</span>expression<span class="token punctuation">)</span>
        statement1
    <span class="token keyword">else</span>
        statement2
</code></pre></div><ol start="3"><li>else if多重选择</li></ol> <div class="language-c extra-class"><pre class="language-c"><code>    <span class="token keyword">if</span> <span class="token punctuation">(</span>score <span class="token operator">&lt;</span> <span class="token number">1000</span><span class="token punctuation">)</span>
        bonus <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>score <span class="token operator">&lt;</span> <span class="token number">1500</span><span class="token punctuation">)</span>
        bonus <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>score <span class="token operator">&lt;</span> <span class="token number">2000</span><span class="token punctuation">)</span>
        bonus <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>score <span class="token operator">&lt;</span> <span class="token number">2500</span><span class="token punctuation">)</span>
        bonus <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span>
        bonus <span class="token operator">=</span> <span class="token number">6</span><span class="token punctuation">;</span>
</code></pre></div><ol start="4"><li>else与if配对</li></ol> <ul><li>如果没有花括号，<code>else</code> 与它上面的离他最近的未配对的 <code>if</code> 配对</li></ul> <ol start="5"><li>多层嵌套的if语句</li></ol> <ul><li>略</li></ul> <h3 id="逻辑运算符"><a href="#逻辑运算符" class="header-anchor">#</a> 逻辑运算符</h3> <ol><li>三种逻辑运算符和备选拼写iso646.h</li></ol> <table><thead><tr><th style="text-align:left;">逻辑运算符</th> <th style="text-align:left;">iso646.h</th> <th style="text-align:left;">含义</th></tr></thead> <tbody><tr><td style="text-align:left;">&amp;&amp;</td> <td style="text-align:left;">and</td> <td style="text-align:left;">与</td></tr> <tr><td style="text-align:left;">||</td> <td style="text-align:left;">or</td> <td style="text-align:left;">或</td></tr> <tr><td style="text-align:left;">！</td> <td style="text-align:left;">not</td> <td style="text-align:left;">非</td></tr></tbody></table> <ol start="2"><li>优先级和求值顺序</li></ol> <ul><li>优先级</li></ul> <p><code>&amp;&amp;</code> 的优先级比 <code>||</code> 高，但是两者的优先级都比关系运算符低，比赋值运算符高，因此</p> <div class="language-c extra-class"><pre class="language-c"><code>a <span class="token operator">&gt;</span> b <span class="token operator">&amp;&amp;</span> b <span class="token operator">&gt;</span> c <span class="token operator">||</span> b <span class="token operator">&gt;</span> d <span class="token comment">//相当于</span>
<span class="token punctuation">(</span><span class="token punctuation">(</span>a <span class="token operator">&gt;</span> b<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>b <span class="token operator">&gt;</span> c<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token punctuation">(</span>b <span class="token operator">&gt;</span> d<span class="token punctuation">)</span>
</code></pre></div><ul><li>求值顺序</li></ul> <p>从 <code>左到右</code> 或 <code>右到左</code> 计算，<code>&amp;&amp;</code> 和 <code>||</code> 运算符都是序列点</p> <p>C 把先计算哪部分的决定权留给编译器的设计者</p> <ol start="3"><li>范围</li></ol> <div class="language-c extra-class"><pre class="language-c"><code>    <span class="token keyword">if</span> <span class="token punctuation">(</span>score <span class="token operator">&gt;=</span> <span class="token number">90</span> <span class="token operator">&amp;&amp;</span> score <span class="token operator">&lt;=</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//正确</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token number">90</span> <span class="token operator">&lt;=</span> score <span class="token operator">&lt;=</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token comment">//语义错误，而不是语法错误</span>
</code></pre></div><p>注意不要写成数学上的 <code>90 &lt;= score &lt;= 100</code>，因为程序会先算 <code>(90&lt; = score)</code> 得到 <code>0</code> 或 <code>1</code></p> <h3 id="一个统计单词的程序"><a href="#一个统计单词的程序" class="header-anchor">#</a> 一个统计单词的程序</h3> <details class="custom-block details"><summary>Check</summary> <div class="language-c extra-class"><pre class="language-c"><code><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;stdio.h&gt;</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;ctype.h&gt;</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;stdbool.h&gt;</span></span>
<span class="token macro property">#<span class="token directive keyword">define</span> STOP '|'</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">char</span> c<span class="token punctuation">;</span>    <span class="token comment">//读入字符</span>
    <span class="token keyword">char</span> prev<span class="token punctuation">;</span> <span class="token comment">//读入的前一个字符</span>
    <span class="token keyword">long</span> n_chars <span class="token operator">=</span> <span class="token number">0L</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> n_lines <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> n_words <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> p_lines <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>     <span class="token comment">//不完整的行数</span>
    bool inword <span class="token operator">=</span> false<span class="token punctuation">;</span> <span class="token comment">//如果c在单词中，inword等于true</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;Enter text to be analyzed(| to terminate):\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    prev <span class="token operator">=</span> <span class="token string">'\n'</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>c <span class="token operator">=</span> <span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">!=</span> STOP<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        n_chars<span class="token operator">++</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>c <span class="token operator">==</span> <span class="token string">'\n'</span><span class="token punctuation">)</span>
            n_lines<span class="token operator">++</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">isspace</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>inword<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            inword <span class="token operator">=</span> true<span class="token punctuation">;</span>
            n_words<span class="token operator">++</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isspace</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> inword<span class="token punctuation">)</span>
            inword <span class="token operator">=</span> false<span class="token punctuation">;</span>
        prev <span class="token operator">=</span> c<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>prev <span class="token operator">=</span> <span class="token string">'\n'</span><span class="token punctuation">)</span>
        p_lines <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;characters = %ld, words = %d, lines = %d, &quot;</span><span class="token punctuation">,</span> n_chars<span class="token punctuation">,</span> n_words<span class="token punctuation">,</span>
           n_lines<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;partial lines = %d\n&quot;</span><span class="token punctuation">,</span> p_lines<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></details> <h3 id="条件运算符"><a href="#条件运算符" class="header-anchor">#</a> 条件运算符 ?:</h3> <ol><li>形式</li></ol> <div class="language-c extra-class"><pre class="language-c"><code><span class="token comment">/* 
如果 expression1为真
则整个表达式的值为 expression2 的值
否则为 expression3 的值 
*/</span>
    expression1 <span class="token operator">?</span> expression2 <span class="token operator">:</span> expression3
</code></pre></div><ol start="2"><li>例子: 取出两个数的较大值</li></ol> <div class="language-c extra-class"><pre class="language-c"><code><span class="token comment">/*
如果 a 大于 b，那么将 max 设置为 a；否则，设置为 b
*/</span>
    max <span class="token operator">=</span> <span class="token punctuation">(</span>a<span class="token operator">&gt;</span>b<span class="token punctuation">)</span> <span class="token operator">?</span> a <span class="token operator">:</span> b<span class="token punctuation">;</span>
</code></pre></div><h3 id="循环辅助：continue和break"><a href="#循环辅助：continue和break" class="header-anchor">#</a> 循环辅助：continue和break</h3> <ol><li>continue 语句</li></ol> <ul><li><p>执行到该语句，会跳过本次迭代的剩余部分，开始下一轮</p></li> <li><p>三种循环都可以使用 <code>continue</code>，但是 <code>switch</code> 语句不行</p></li></ul> <ol start="2"><li>break 语句</li></ol> <ul><li><p>执行到循环中的 <code>break</code> 语句，会终止包含它的循环</p></li> <li><p>三种循环都可以使用 <code>break</code>，包括 <code>switch</code> 语句</p></li> <li><p>嵌套循环中使用 <code>continue</code> 和 <code>break</code> 对本层循环有效</p></li></ul> <h3 id="多重选择：swithc和break"><a href="#多重选择：swithc和break" class="header-anchor">#</a> 多重选择：swithc和break</h3> <ol><li>switch 语句形式</li></ol> <div class="language-c extra-class"><pre class="language-c"><code>    <span class="token keyword">switch</span> <span class="token punctuation">(</span>expression<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">case</span> label1 <span class="token operator">:</span> statement1 <span class="token comment">//使用break 跳出 switch</span>
        <span class="token keyword">case</span> label2 <span class="token operator">:</span> statement2
        <span class="token keyword">default</span> <span class="token operator">:</span> statement3
    <span class="token punctuation">}</span> 
</code></pre></div><ul><li><p>如果没有匹配的标签？如果有 <code>default</code> : 标签行，就跳转至该行；否则，程序继续执行在 <code>switch</code> 后面的语句</p></li> <li><p>如果没有 <code>break</code> 语句，就会从匹配标签开始执行到 <code>switch</code> 末尾</p></li> <li><p>另外，C语言的 <code>case</code> 一般都指定一个值，不能使用一个范围</p></li></ul> <ol start="2"><li>多重标签</li></ol> <div class="language-c extra-class"><pre class="language-c"><code>    <span class="token keyword">switch</span> <span class="token punctuation">(</span>ch<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">case</span> <span class="token string">'a'</span><span class="token operator">:</span> <span class="token keyword">case</span> <span class="token string">'A'</span><span class="token operator">:</span>a_cnt <span class="token operator">++</span><span class="token punctuation">;</span>
        <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">case</span><span class="token string">'b'</span><span class="token operator">:</span> <span class="token keyword">case</span> <span class="token string">'B'</span> <span class="token operator">:</span>b_cnt<span class="token operator">++</span><span class="token punctuation">;</span>
        <span class="token keyword">break</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><ol start="3"><li>只读每行的首字符</li></ol> <div class="language-c extra-class"><pre class="language-c"><code><span class="token comment">/*
这种经常出现在响应单字符的交互程序中
*/</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token string">'\n'</span><span class="token punctuation">)</span>
        <span class="token keyword">continue</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-c extra-class"><pre class="language-c"><code><span class="token comment">/*
假设用户一开始就按下 Enter 键，那么程序读到的首个字符就是换行符 
*/</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>ch <span class="token operator">==</span> <span class="token string">'\n'</span><span class="token punctuation">)</span>
        <span class="token keyword">continue</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="goto语句"><a href="#goto语句" class="header-anchor">#</a> goto语句</h3> <ol><li>goto 语句包含两部分: goto 和 标签名</li></ol> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">goto</span> part2<span class="token punctuation">;</span>                       <span class="token comment">//跳到 part2 一行，并执行语句</span>
part2<span class="token operator">:</span><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;go to part2.\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">//part2 是标签名，可使用 goto 跳到这</span>
</code></pre></div><ul><li><p>除了多重循环时 <code>break</code> 无法跳出全部循环时，可以借助 <code>goto</code> 来跳出循环</p></li> <li><p>其他情况下没有必要（最好不要）使用 <code>goto</code></p></li></ul> <h2 id="ch8-字符输入-输出和输入验证"><a href="#ch8-字符输入-输出和输入验证" class="header-anchor">#</a> Ch8 字符输入/输出和输入验证</h2> <h3 id="单字符io：getchar-和putchar"><a href="#单字符io：getchar-和putchar" class="header-anchor">#</a> 单字符IO：getchar()和putchar()</h3> <p><code>getchar()</code> 每次读入一个字符，<code>putchar()</code> 每次输出一个字符</p> <p>利用这两个函数，可以写出一个“复读机”</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;stdio.h&gt;</span></span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">char</span> ch<span class="token punctuation">;</span>
	<span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>ch <span class="token operator">=</span> <span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token string">'#'</span><span class="token punctuation">)</span>  <span class="token comment">//当读入的字符不是'#' 就一直复读下去</span>
		<span class="token function">putchar</span><span class="token punctuation">(</span>ch<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="缓冲区"><a href="#缓冲区" class="header-anchor">#</a> 缓冲区</h3> <ol><li>缓冲区 (<em>buffer</em>)</li></ol> <p>缓冲区是一个临时存储区。输入的字符被储存在缓冲区，按下Enter时，程序才使用你输入的字符</p> <p>使用缓冲区可以把若干字符作为一个块进行传输，比逐个发送字符节约时间</p> <p>但有些情况下，也需要无缓冲输入（如游戏中，希望按下按键就执行指令）</p> <ol start="2"><li>缓冲分为两类：完全缓冲I/O 和 行缓冲I/O。</li></ol> <p>完全缓冲输入：缓冲区被填满时才刷新缓冲区（内容送到目的地），通常在文件输入中</p> <p>行缓冲I/O：在出现 <code>换行符</code> 时刷新缓冲区。键盘输入通常是行缓冲输入，按下Enter时刷新缓冲区</p> <h3 id="结束键盘输入"><a href="#结束键盘输入" class="header-anchor">#</a> 结束键盘输入</h3> <ol><li>文件、流和键盘输入</li></ol> <ul><li>文件（<em>file</em>）</li></ul> <p>文件是存储器中存储信息的区域。文件一般保持在硬盘、U盘中C可以通过调用底层I/O或调用标准I/O来处理文件</p> <ul><li>流（<em>stream</em>）</li></ul> <p>流是一个实际输入或输出映射的理想化数据流。这意味着不同类型的输入可以用统一的流表示。于是，打开文件的过程就是将文件和流相关联。然后通过流进行读写文件，C语言处理的是流而不直接处理文件。</p> <ol start="2"><li>文件结尾</li></ol> <p><code>Ctrl+Z</code> 标记文件结尾</p> <p>在C语言中，用 <code>getchar()</code> 读取文件结尾时返回一个特殊的值：EOF（<code>end of file</code>）</p> <p><code>scanf</code> 读到文件结尾也返回 <code>EOF</code></p> <p>可以使用下面的表达式：</p> <p><code>while ((ch == getchar()) != EOF)</code> 来判断是否到达末尾</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;stdio.h&gt;</span></span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">int</span> ch<span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>ch <span class="token operator">=</span> <span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token constant">EOF</span><span class="token punctuation">)</span>
        <span class="token function">putchar</span><span class="token punctuation">(</span>ch<span class="token punctuation">)</span><span class="token punctuation">;</span>
    	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre></div><blockquote><p>注：在window中，可以按下 Ctrl+Z 可以模拟文件结尾来结束程序</p></blockquote> <h3 id="重定向和文件"><a href="#重定向和文件" class="header-anchor">#</a> 重定向和文件</h3> <ol><li>重定向输入 &lt;</li></ol> <blockquote><p>重定向输入：让程序用文件输入，而不是键盘  .</p></blockquote> <blockquote><p>注：words.txt 和 .exe 文件要放在同一个文件夹（或加上绝对路径也行。注意路径\要写成\\）</p></blockquote> <p>编译我们上面的复读机程序，得到一个 <strong>.exe</strong> 文件</p> <p>运行 <strong>cmd</strong> ，cd 进入 <strong>.exe</strong> 文件所在文件夹，输入 <strong>.exe</strong> 的文件名即可执行该程序。</p> <p>如果想使用程序处理文本文件（<em>text file</em>），比如一个名为 <code>words</code> 的 <strong>.txt</strong> 文件，可以使用如下命令：</p> <div class="language-sh extra-class"><pre class="language-sh"><code>cPrimerPlusTest <span class="token operator">&lt;</span>words.txt  
</code></pre></div><ol start="2"><li>重定向输出 &gt;</li></ol> <blockquote><p>重定向输出：让程序输出至文件，而不是屏幕</p></blockquote> <blockquote><p>注：它创建了一个名为 mywords 的新文件</p></blockquote> <p>用程序将键盘输入的内容发送到 <code>mywords.txt</code> 中：(和重定向输入类似，只是改变箭头方向)</p> <div class="language-sh extra-class"><pre class="language-sh"><code>cPrimerPlusTest <span class="token operator">&gt;</span>mywords.txt  
</code></pre></div><p>运行后执行程序，按下 <strong>Ctrl+Z</strong> 程序结束后，会将输出的内容送到 <code>mywords.txt</code> 文件中。</p> <ol start="3"><li>组合重定向</li></ol> <p>如果你希望制作一份 <code>mywords.txt</code> 的副本，并命名为 <code>savewords</code> 只要使用下面命令：</p> <div class="language-sh extra-class"><pre class="language-sh"><code>echo_eof <span class="token operator">&lt;</span>mywords.txt <span class="token operator">&gt;</span>savewords
<span class="token comment"># 或</span>
echo_eof <span class="token operator">&gt;</span>savewords <span class="token operator">&lt;</span>mywords.txt
<span class="token comment"># 因为命令与重定向运算符的顺序无关</span>
</code></pre></div><p><code>&gt;&gt;</code> 运算符 可以将数据添加到现有文件的末尾</p> <p><code>|</code> 运算符 可以将一个文件的输出 连接到另一个文件的输入</p> <h3 id="创建更友好的用户界面"><a href="#创建更友好的用户界面" class="header-anchor">#</a> 创建更友好的用户界面</h3> <ol><li>使用缓冲输入</li></ol> <p>缓冲输入要求用户按下 <strong>Enter</strong> 键发送输入，按下 <strong>Enter</strong> 时也产生了换行符，程序须考虑这个换行符</p> <ol start="2"><li>混合数值和字符输入</li></ol> <p>假设程序用 <code>getchar()</code> 处理字符输入，<code>scanf()</code> 处理数值输入，但是尽量不要混用这两个</p> <p>因为 <code>getchar()</code> 读取每个字符，包括（空格、制表符和换行符）</p> <p>而 <code>scanf()</code> 读取数字时会跳过空白符（空格、制表符和换行符）</p> <h3 id="输入验证"><a href="#输入验证" class="header-anchor">#</a> 输入验证</h3> <p>实际应用中，用户可能会输入一些非法值，导致程序异常，编程时应该检测处理这个问题（非法输入）</p> <details class="custom-block details"><summary>下面是一个对非法输入进行判断的程序</summary> <div class="language-c extra-class"><pre class="language-c"><code><span class="token comment">// checking.c --输入验证</span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdbool.h&gt;</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h&gt;</span></span>
<span class="token comment">//验证输入时一个整数</span>
<span class="token keyword">long</span> <span class="token function">get_long</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//验证范围的上下限是否有数</span>
bool <span class="token function">bad_limits</span><span class="token punctuation">(</span><span class="token keyword">long</span> begin<span class="token punctuation">,</span> <span class="token keyword">long</span> end<span class="token punctuation">,</span> <span class="token keyword">long</span> low<span class="token punctuation">,</span> <span class="token keyword">long</span> high<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//计算a~b之间的整数平方和</span>
<span class="token keyword">double</span> <span class="token function">sum_squares</span><span class="token punctuation">(</span><span class="token keyword">long</span> a<span class="token punctuation">,</span> <span class="token keyword">long</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token keyword">long</span> MIN <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1000000L</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> <span class="token keyword">long</span> MAX <span class="token operator">=</span> <span class="token operator">+</span><span class="token number">1000000L</span><span class="token punctuation">;</span>
    <span class="token keyword">long</span> start<span class="token punctuation">;</span>
    <span class="token keyword">long</span> stop<span class="token punctuation">;</span>
    <span class="token keyword">double</span> answer<span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;程序计算上下限之间的整数的平方和(输入两个0退出)\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;lower limit: &quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    start <span class="token operator">=</span> <span class="token function">get_long</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;upper limit: &quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    stop <span class="token operator">=</span> <span class="token function">get_long</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>start <span class="token operator">!=</span> <span class="token number">0</span> <span class="token operator">||</span> stop <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">bad_limits</span><span class="token punctuation">(</span>start<span class="token punctuation">,</span> stop<span class="token punctuation">,</span> MIN<span class="token punctuation">,</span> MAX<span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;try again\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">else</span> <span class="token punctuation">{</span>
            answer <span class="token operator">=</span> <span class="token function">sum_squares</span><span class="token punctuation">(</span>start<span class="token punctuation">,</span> stop<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;The sum of the squares of the integers &quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;from %ld to %ld is %g\n&quot;</span><span class="token punctuation">,</span> start<span class="token punctuation">,</span> stop<span class="token punctuation">,</span> answer<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;lower limit: &quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        start <span class="token operator">=</span> <span class="token function">get_long</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;upper limit: &quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        stop <span class="token operator">=</span> <span class="token function">get_long</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;Done.\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">long</span> <span class="token function">get_long</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">long</span> input<span class="token punctuation">;</span>
    <span class="token keyword">char</span> ch<span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">&quot;%ld&quot;</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>input<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment">//这里对输入进行了判断</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>ch <span class="token operator">=</span> <span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token string">'\n'</span><span class="token punctuation">)</span>
            <span class="token function">putchar</span><span class="token punctuation">(</span>ch<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;非整数，请输入整数:&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> input<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">double</span> <span class="token function">sum_squares</span><span class="token punctuation">(</span><span class="token keyword">long</span> a<span class="token punctuation">,</span> <span class="token keyword">long</span> b<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">double</span> total <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">long</span> i<span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> a<span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> b<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
        total <span class="token operator">+=</span> <span class="token punctuation">(</span><span class="token keyword">double</span><span class="token punctuation">)</span>i <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token keyword">double</span><span class="token punctuation">)</span>i<span class="token punctuation">;</span>
    <span class="token keyword">return</span> total<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
bool <span class="token function">bad_limits</span><span class="token punctuation">(</span><span class="token keyword">long</span> begin<span class="token punctuation">,</span> <span class="token keyword">long</span> end<span class="token punctuation">,</span> <span class="token keyword">long</span> low<span class="token punctuation">,</span> <span class="token keyword">long</span> high<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    bool not_good <span class="token operator">=</span> false<span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>begin <span class="token operator">&gt;</span> end<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;%ld 比 %ld大.\n&quot;</span><span class="token punctuation">,</span> begin<span class="token punctuation">,</span> end<span class="token punctuation">)</span><span class="token punctuation">;</span>
        not_good <span class="token operator">=</span> true<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>begin <span class="token operator">&lt;</span> low <span class="token operator">||</span> end <span class="token operator">&lt;</span> low<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;输入应该比%ld大\n&quot;</span><span class="token punctuation">,</span> low<span class="token punctuation">)</span><span class="token punctuation">;</span>
        not_good <span class="token operator">=</span> true<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>begin <span class="token operator">&gt;</span> high <span class="token operator">||</span> end <span class="token operator">&gt;</span> high<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;输入应该比%ld小\n&quot;</span><span class="token punctuation">,</span> high<span class="token punctuation">)</span><span class="token punctuation">;</span>
        not_good <span class="token operator">=</span> true<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> not_good<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></details> <ol><li>分析程序</li></ol> <ul><li><p>使用独立函数（模块）来验证输入和管理显示，程序越大，使用模块化编程就越重要</p></li> <li><p>main() 函数管理程序流，为其他函数委派任务</p></li></ul> <ol start="2"><li>输入流和数字</li></ol> <ul><li>输入流由字符组成，但是 <code>scanf()</code> 可以把输入转换成整数值或浮点数值</li></ul> <h3 id="菜单浏览"><a href="#菜单浏览" class="header-anchor">#</a> 菜单浏览</h3> <ul><li><p>C 的 switch 语句是根据选项决定行为的好工具</p></li> <li><p>while 语句可以实现重复访问菜单的功能</p></li> <li><p>程序顺利执行：处理正确输入和错误输入时都能顺利运行</p></li> <li><p>在图形化程序中，可以通过按钮来限制用户的操作；但是我们的命令行程序中，无法预知用户的行为。例如在选择菜单选项时，用户可能会输入一些意外的选项。通常用一个 <code>while</code> 循环来处理输入。</p></li></ul> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;请输入字母做出选择:\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;a. advice       b. bell\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;c. count        q. quit\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ch <span class="token operator">=</span> <span class="token function">get_first</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">while</span><span class="token punctuation">(</span><span class="token punctuation">(</span>ch <span class="token operator">&lt;</span> <span class="token string character">'a'</span> <span class="token operator">||</span> ch <span class="token operator">&gt;</span> <span class="token string character">'c'</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> ch <span class="token operator">!=</span> <span class="token string character">'q'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;Please respond with a, b, c, or q. \n&quot;</span><span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ch <span class="token operator">=</span> <span class="token function">get_first</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>另一个问题是，用户正常输入时由于按下 <strong>Enter</strong> 会产生一个多余的换行符，这会使程序认为用户进行非法输入，产生提示。可以用类似下面这样的方法将多余的字符跳过</li></ul> <p>注：<code>get_first(void)</code> 函数将读取一行的第一个字符，然后跳过这一行</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">char</span> <span class="token function">get_first</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">int</span> ch<span class="token punctuation">;</span>
    ch <span class="token operator">=</span> <span class="token function">getcahr</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token string">'\n'</span><span class="token punctuation">)</span>
        <span class="token keyword">continue</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> ch<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="ch9-函数"><a href="#ch9-函数" class="header-anchor">#</a> Ch9 函数</h2> <h3 id="复习函数"><a href="#复习函数" class="header-anchor">#</a> 复习函数</h3> <ol><li>分析</li></ol> <ul><li><p>函数原型：告知编译器函数的类型；</p></li> <li><p>函数调用：表明在此处执行函数；</p></li> <li><p>函数定义：提供实际的代码；</p></li> <li><p>函数中的变量是局部变量 (<em>local variable</em>)</p></li></ul> <ol start="2"><li>定义带形式参数的函数</li></ol> <ul><li><p>形式参数于是局部变量，属于该函数私有</p></li> <li><p>ANSI 要求在每个变量前都声明其类型</p></li></ul> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">void</span> <span class="token function">dibs</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> z<span class="token punctuation">)</span>         <span class="token comment">// 无效</span>
<span class="token keyword">void</span> <span class="token function">dibs</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">,</span> <span class="token keyword">int</span> y<span class="token punctuation">,</span> <span class="token keyword">int</span> z<span class="token punctuation">)</span> <span class="token comment">// 有效</span>
<span class="token keyword">void</span> <span class="token function">dibs</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> z<span class="token punctuation">)</span>             <span class="token comment">// 有效</span>
<span class="token keyword">int</span> x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> z<span class="token punctuation">;</span>
</code></pre></div><ol start="3"><li>声明带形式参数函数的原型</li></ol> <ul><li>函数原型用逗号的列表指明参数的数量和类型。根据个人喜好，可省去变量名</li></ul> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">void</span> <span class="token function">show_n_char</span><span class="token punctuation">(</span><span class="token keyword">char</span> ch<span class="token punctuation">,</span> <span class="token keyword">int</span> num<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ul><li>在原型中使用变量名并没有实际创建变量，<code>char</code> 仅代表了一个 <code>char</code> 类型的变量，以此类推</li></ul> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">void</span> <span class="token function">show_n_char</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ul><li>这种形式最终会被剔除</li></ul> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">void</span> <span class="token function">show_n_char</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>一个支持 <strong>ANSI C</strong> 的编译器会假定用户没有用函数原型来声明函数，它将不会检查参数。</p> <p>为了表明函数没有参数应加 <code>void</code> 关键字</p> <ol start="4"><li>调用带实际参数的函数</li></ol> <ul><li><p>形式参数是 <strong>被调函数</strong> 中的变量，实际参数是 <strong>主调函数</strong> 赋给被调函数的具体值</p></li> <li><p><strong>实际参数</strong> 是出现在函数调用圆括号中的表达式；<strong>形式参数</strong> 是函数定义的函数头中声明的变量</p></li></ul> <ol start="5"><li><p>黑盒里发生了什么对主调函数是不可见的</p></li> <li><p>使用 return 从函数中返回值</p></li></ol> <ul><li><p>函数的返回值可以把信息从<strong>被调函数</strong>传回<strong>主调函数</strong></p></li> <li><p>如果函数返回值类型与函数声明的类型不匹配会怎样？</p></li></ul> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">int</span> <span class="token function">what_if</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">double</span> z <span class="token operator">=</span> <span class="token number">100.0</span> <span class="token operator">/</span> <span class="token punctuation">(</span><span class="token keyword">double</span><span class="token punctuation">)</span> n<span class="token punctuation">;</span>
    <span class="token keyword">return</span> z<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-c extra-class"><pre class="language-c"><code>result <span class="token operator">=</span> <span class="token function">what_if</span><span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>虽然在 <code>what_if</code> 函数中赋给 z 的值是 1.5625，但是 <code>return</code> 语句返回是 <code>int</code> 类型的值 1</p> <ul><li>return 语句会导致终止函数，并把控制返回给主调函数。</li></ul> <ol start="7"><li>函数类型</li></ol> <ul><li>声明函数时必须声明函数的类型。如果没声明函数类型，旧版本的 C 编译器会假定函数的类型是 <code>int</code>，然而，C99 标准不再支持 <code>int</code> 类型函数的这种假定设置。</li></ul> <h3 id="ansi-c函数原型"><a href="#ansi-c函数原型" class="header-anchor">#</a> ANSI C函数原型</h3> <ol><li>问题所在</li></ol> <ul><li>主调函数把它的参数储存在被称为栈 (<em>stack</em>) 的临时储存区，被调函数从栈中读取这些参数</li></ul> <ol start="2"><li>ANSI 的解决方案</li></ol> <ul><li>错误和警告的区别是：错误导致无法编译，而警告仍然允许编译。</li></ul> <ol start="3"><li>函数原型的优点</li></ol> <ul><li>函数定义放在 main 前，可不需要函数原型声明</li></ul> <h3 id="递归-recursion"><a href="#递归-recursion" class="header-anchor">#</a> 递归 (<em>recursion</em>)</h3> <ol><li><p>递归演示</p></li> <li><p>递归基本原理</p></li> <li><p>尾递归</p></li></ol> <ul><li>最简单递归形式是把递归调用置于函数的末尾，即正好在 <code>return</code> 语句之前。这种形式的递归被称为尾递归，因为递归调用在函数的末尾</li></ul> <ol start="4"><li>递归和倒序计算</li></ol> <ul><li><p>递归在处理倒序时非常方便 (在解决这类问题中，递归比循环简单)</p></li> <li><p>十进制 (<em>decimal</em>) 转二进制 (<em>binary</em>)</p></li></ul> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">void</span> <span class="token function">to_binary</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">long</span> n<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">int</span> r<span class="token punctuation">;</span>

    r <span class="token operator">=</span> n <span class="token operator">%</span> <span class="token number">2</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>n <span class="token operator">&gt;=</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token function">to_binary</span><span class="token punctuation">(</span>n <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token function">putchar</span><span class="token punctuation">(</span>r <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">?</span> <span class="token string">'0'</span> <span class="token operator">:</span> <span class="token string">'1'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><ol start="5"><li>递归的优缺点</li></ol> <ul><li><p>优点：递归为某些编程问题提供了最简单的解决方案</p></li> <li><p>缺点：一些递归算法会快速消耗计算机的内存资源</p></li> <li><p>所有的 C 函数皆平等，每个函数都可以调用其他函数，或者被其他函数调用；<code>main()</code> 也可以被自己或其他函数调用递归调用————尽管很少这样做</p></li></ul> <h3 id="使用头文件"><a href="#使用头文件" class="header-anchor">#</a> 使用头文件</h3> <ul><li><p>更好做法是，把 <code>#define</code> 指令放进头文件，然后在每个源文件中使用 <code>#include</code> 指令包含该文件</p></li> <li><p>注意 menu() 函数中是如何检查非数值输入和超出范围的数据</p></li></ul> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">while</span><span class="token punctuation">(</span><span class="token punctuation">(</span>status <span class="token operator">=</span> <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">&quot;%d, &amp;code&quot;</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">1</span> <span class="token operator">||</span> <span class="token punctuation">(</span>code <span class="token operator">&lt;</span> <span class="token number">1</span> <span class="token operator">||</span> code <span class="token operator">&gt;</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p>只有在 <code>scanf()</code> 成功读入一个整数值后，才会检查 code 的值</p> <h3 id="查找地址：-运算符"><a href="#查找地址：-运算符" class="header-anchor">#</a> 查找地址：&amp;运算符</h3> <ul><li><p><code>%p</code> 是输出地址的转换说明</p></li> <li><p>概括地说，如果主调函数不使用 <code>return</code> 返回的值，则必须通过地址才能修改主调函数中的值</p></li> <li><p>PC 地址通常用十六进制(<em>Hexadecimal</em>)表示</p></li> <li><p>每个十六进制数对应 4 位，该例显示 12 个十六进制数，对应 48 位地址</p></li></ul> <h3 id="更改主调函数中的变量"><a href="#更改主调函数中的变量" class="header-anchor">#</a> 更改主调函数中的变量</h3> <ul><li>用 <code>return</code> 语句只能把被调函数中的一个值传回主调函数，要传回两个值，请使用指针！</li></ul> <h3 id="指针简介"><a href="#指针简介" class="header-anchor">#</a> 指针简介</h3> <ol><li>间接运算符：*</li></ol> <div class="language-c extra-class"><pre class="language-c"><code>val <span class="token operator">=</span> <span class="token operator">*</span>ptr<span class="token punctuation">;</span> <span class="token comment">//找出 ptr 指向的值</span>
语句 ptr <span class="token operator">=</span> <span class="token operator">&amp;</span>bah<span class="token punctuation">;</span>和 val <span class="token operator">=</span> <span class="token operator">*</span>ptr<span class="token punctuation">;</span>放在一起相当于下面的语句<span class="token punctuation">;</span>
val <span class="token operator">=</span> bah<span class="token punctuation">;</span>
</code></pre></div><p>使用地址和间接运算符可以间接完成上面这条语句的功能，这是“间接运算符”的由来</p> <ul><li><p>地址运算符：<code>&amp;</code> 后跟一个变量名时，&amp; 给出该变量的地址。</p></li> <li><p>间接运算符：<code>*</code> 后跟一个指针名或地址时，* 给出存储在指针指向地址上的值。</p></li></ul> <ol start="2"><li>声明指针</li></ol> <div class="language-c extra-class"><pre class="language-c"><code>    pointer ptr<span class="token punctuation">;</span> <span class="token comment">//不能这样声明指针，因为要指定指针所指向变量的类型</span>
    <span class="token keyword">int</span> <span class="token operator">*</span> pi<span class="token punctuation">;</span>    <span class="token comment">//pi 是指向 int 类型的指针</span>
    <span class="token keyword">int</span> <span class="token operator">*</span> pc<span class="token punctuation">;</span>    <span class="token comment">//pc 是指向 char 类型变量的指针</span>
</code></pre></div><ul><li><p><code>*</code>和指针名之间的空格可有可无，通常声明时使用空格，解引用变量时省略空格</p></li> <li><p>指针实际上是一个新类型，不是整数类型</p></li></ul> <ol start="3"><li>使用指针在函数间通信</li></ol> <p>第一种形式，</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">int</span> <span class="token function">function1</span><span class="token punctuation">(</span><span class="token keyword">int</span> num<span class="token punctuation">)</span>
</code></pre></div><p>第二种形式，</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">int</span> <span class="token function">function2</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">*</span> ptr<span class="token punctuation">)</span>
</code></pre></div><h2 id="ch10-数组与指针"><a href="#ch10-数组与指针" class="header-anchor">#</a> Ch10 数组与指针</h2> <p>数组由数据类型相同的一系列元素组成。使用数组时，通过声明数组告诉编译器数组中含有多少元素和这些元素的类型。</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token comment">/* 一些数组声明 */</span>
<span class="token keyword">float</span> candy<span class="token punctuation">[</span><span class="token number">365</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">char</span> code<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="数组"><a href="#数组" class="header-anchor">#</a> 数组</h3> <ol><li>初始化数组</li></ol> <p>使用{}来初始化数组：</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">int</span> powers<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><div class="custom-block tip"><p class="custom-block-title">使用 const 前缀声明数组，可以把数组设置为只读。</p></div> <p>例如：</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">const</span> <span class="token keyword">int</span> powers<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><div class="custom-block tip"><p class="custom-block-title">初始化数组时可以省略方括号里的数字，编译器会根据初始化列表中的项数来确定数组大小。</p></div> <p>例如:</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">int</span> powers<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>使用 <code>for</code> 循环遍历数组时，可以让计算机计算数组大小，例如一个数组 days[]，通过</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token comment">/*
sizeof days 得到数组大小，
sizeof days[0] 得到单个数组大小，相除得到个数
*/</span>
<span class="token keyword">sizeof</span> days <span class="token operator">/</span> <span class="token keyword">sizeof</span> days<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token comment">// 可得元素个数。</span>
</code></pre></div><ol start="2"><li>指定初始化器</li></ol> <p><strong>C99</strong> 可以初始化指定的数组元素：</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">int</span> arr<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token punctuation">{</span> <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">212</span><span class="token punctuation">}</span>
</code></pre></div><ol start="3"><li>给数组元素赋值</li></ol> <p>使用元素下标给数组元素赋值。</p> <div class="language-c extra-class"><pre class="language-c"><code>a<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span>
</code></pre></div><ol start="4"><li>数组边界</li></ol> <p>防止数组下标越界。如果声明数组</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">int</span> arr<span class="token punctuation">[</span>N<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">//数组下标范围是 (0 ~ N-1)</span>
</code></pre></div><ol start="5"><li>指定数组的大小（略）</li></ol> <h3 id="多维数组"><a href="#多维数组" class="header-anchor">#</a> 多维数组</h3> <p>多维数组可以看成是 数组 的 数组。如：</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">int</span> day<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">31</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token comment">// 可以看成是 day 有 12 个元素，每个元素都是一个包含 31 个int的数组。</span>
</code></pre></div><ol><li><p>初始化二维数组</p></li> <li><p>其他多维数组</p></li></ol> <h3 id="指针和数组"><a href="#指针和数组" class="header-anchor">#</a> 指针和数组</h3> <p>数组是变相的指针。</p> <p><code>a == &amp;a[0]</code> 数组名是首元素的地址。</p> <h3 id="函数和指针"><a href="#函数和指针" class="header-anchor">#</a> 函数和指针</h3> <p>传递数组给函数：</p> <p>int sum(int *ar, int n);</p> <p>等价于</p> <p>int sum(int ar[], int n);</p> <ol><li>使用指针形参</li></ol> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">int</span> <span class="token function">sump</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">*</span>start<span class="token punctuation">,</span> <span class="token keyword">int</span> <span class="token operator">*</span> end<span class="token punctuation">)</span><span class="token punctuation">{</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token keyword">while</span><span class="token punctuation">(</span>start <span class="token operator">&lt;</span> end<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre></div><ol start="2"><li>指针表示法和数组表示法</li></ol> <h3 id="指针操作"><a href="#指针操作" class="header-anchor">#</a> 指针操作</h3> <table><thead><tr><th style="text-align:left;">1</th></tr></thead> <tbody><tr><td style="text-align:left;">赋值</td></tr> <tr><td style="text-align:left;">解除引用</td></tr> <tr><td style="text-align:left;">取值</td></tr> <tr><td style="text-align:left;">指针与整数相加</td></tr> <tr><td style="text-align:left;">递增</td></tr> <tr><td style="text-align:left;">减</td></tr> <tr><td style="text-align:left;">递减</td></tr> <tr><td style="text-align:left;">指针求差</td></tr> <tr><td style="text-align:left;">比较</td></tr></tbody></table> <p>使用指针时，尽量在声明时进行初始化，防止出现</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">int</span> <span class="token operator">*</span>pt<span class="token punctuation">;</span>
<span class="token operator">*</span>pt <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>

<span class="token comment">/*
这种解引用未初始化的指针会导致未知错误
所以 5 会被存在一个不确定的地方
*/</span>
</code></pre></div><h3 id="保护数组中的数据"><a href="#保护数组中的数据" class="header-anchor">#</a> 保护数组中的数据</h3> <p>传递地址会导致一些问题，原始数据可能会被修改。</p> <ol><li>对形式参数使用const</li></ol> <p>如果函数不想修改数组中的数据，可在函数原型和函数定义中使用const:</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">int</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">int</span> ar<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">int</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ol start="2"><li>const的其他内容</li></ol> <h3 id="指针和多维数组"><a href="#指针和多维数组" class="header-anchor">#</a> 指针和多维数组</h3> <p>C语言的一个难点。如果觉得难理解，结合例子学会用法即可，一般用到二维数组。</p> <h3 id="变长数组（vla）"><a href="#变长数组（vla）" class="header-anchor">#</a> 变长数组（VLA）</h3> <p>允许使用变量表示数组的维度：</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">int</span> q <span class="token operator">=</span> <span class="token number">4</span> <span class="token punctuation">;</span> 
<span class="token keyword">int</span> r <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>
<span class="token keyword">double</span> sales<span class="token punctuation">[</span>q<span class="token punctuation">]</span><span class="token punctuation">[</span>r<span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="复合字面量"><a href="#复合字面量" class="header-anchor">#</a> 复合字面量</h3> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">int</span> diva<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">}</span> <span class="token comment">//数组</span>
<span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">}</span>     <span class="token comment">//复合字面量</span>
</code></pre></div><p>复合字面量是匿名的，需要在创建同时使用。或是用指针记录地址：</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">int</span> <span class="token operator">*</span> pt1 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="ch11-字符串和字符串函数"><a href="#ch11-字符串和字符串函数" class="header-anchor">#</a> Ch11 字符串和字符串函数</h2> <h3 id="表示字符串和字符串i-o"><a href="#表示字符串和字符串i-o" class="header-anchor">#</a> 表示字符串和字符串I/O</h3> <ol><li>在程序中定义字符串</li></ol> <ul><li>字符串字面量</li></ul> <p>双引号括起来的内容 为字符串字面量 或称为字符串常量。</p> <p>字符串常量属于静态(static)存储类别，如果在函数中使用字符串常量，在字符串只会被存储一次，在整个程序生命期内存在。</p> <ul><li>字符串数组和初始化</li></ul> <p>定义字符串数组：</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">const</span> <span class="token keyword">char</span> m1<span class="token punctuation">[</span><span class="token number">40</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;Limit youtself to one line's worth.&quot;</span><span class="token punctuation">;</span>
</code></pre></div><p>可以省略数组大小，让编译器自动计算数组大小：</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">const</span> <span class="token keyword">char</span> m2<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;Limit youtself to one line's worth.&quot;</span><span class="token punctuation">;</span>
</code></pre></div><p>使用指针表示法创建字符串：</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> pt1 <span class="token operator">=</span> <span class="token string">&quot;Something is pointing at me.&quot;</span><span class="token punctuation">;</span>
</code></pre></div><ul><li>数组和指针</li></ul> <p>初始化数组把静态存储区的字符串拷贝到数组中，初始化指针只把字符串的地址拷贝给指针。</p> <ul><li>数组和指针的区别</li></ul> <p>略</p> <ol start="2"><li>指针和字符串</li></ol> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span> msg <span class="token operator">=</span> <span class="token string">&quot;Don't be a fool!&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span> copy<span class="token punctuation">;</span>
copy <span class="token operator">=</span> msg<span class="token punctuation">;</span>
</code></pre></div><p>这里的复制是让copy指向msg指向的地址，而不是将字符串拷贝过来。</p> <h3 id="字符串输入"><a href="#字符串输入" class="header-anchor">#</a> 字符串输入</h3> <p>读入字符串：1.分配空间，2.用输入函数获取该字符串（存到之前分配的空间）。</p> <ol><li>分配空间</li></ol> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">char</span> <span class="token operator">*</span> name<span class="token punctuation">;</span>
<span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">&quot;%s&quot;</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>在读入name时，name未初始化，所以会把数据存到不确定的地方。所以，不要写这种东西。</p> <p>可以使用数组分配空间：</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">char</span> name<span class="token punctuation">[</span><span class="token number">81</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div><p>之后可以用读取字符串函数 (如scanf) 读字符串到name中。</p> <ol start="2"><li>gets()函数</li></ol> <p>//由于可能导致缓冲区溢出，产生安全问题。在 C11 中已经被废除</p> <p>gets()  读取整行输入，直到遇到换行符，然后丢弃换行符。</p> <p>puts() 用于显示字符串，并在末尾添加换行符。</p> <details class="custom-block details"><summary>Check</summary> <div class="language-c extra-class"><pre class="language-c"><code><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;stdio.h&gt;</span></span>
<span class="token macro property">#<span class="token directive keyword">define</span> STLEN 81</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">char</span> words<span class="token punctuation">[</span>STLEN<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">&quot;Enter a string,Please.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">gets</span><span class="token punctuation">(</span>words<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;Yout string twice:\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;%s\n&quot;</span><span class="token punctuation">,</span>words<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">puts</span><span class="token punctuation">(</span>words<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">&quot;Done.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></details> <ol start="3"><li>gets()的替代品</li></ol> <ul><li>fgets() 函数</li></ul> <p>fgets()函数通过第2个参数（例如n）限制读入的字符数来解决溢出问题。</p> <p>fgets()将读取n-1个字符或遇到第一个换行符为止。fgets()读到的换行会存在字符串中。</p> <p>fgets()第3个函数指明要读入的文件。如果用stdin 可表示从键盘输入</p> <p>通常与fputs()配对使用。fputs()第二个参数表示要写入的文件，如果是stdout，就是输出在显示器上。</p> <ul><li>gets_s() 函数</li></ul> <p>用第二个参数限制读入的字符数。</p> <ul><li>scanf() 函数</li></ul> <p>略</p> <h3 id="字符串输出"><a href="#字符串输出" class="header-anchor">#</a> 字符串输出</h3> <p>put(字符串地址)</p> <p>fput(字符串地址，文件)</p> <p>printf()  //可以格式化输出</p> <h3 id="自定义输入-输出函数"><a href="#自定义输入-输出函数" class="header-anchor">#</a> 自定义输入/输出函数</h3> <p>可以利用 <code>getchar()</code> 和 <code>putchar()</code> 自定义函数来处理字符串。</p> <h3 id="字符串函数-string-h"><a href="#字符串函数-string-h" class="header-anchor">#</a> 字符串函数 string.h</h3> <p>strlen()  //获取字符串长度</p> <p>strcat() //拼接字符串</p> <p>strncat()//拼接n长度的字符串</p> <p>strcmp()//比较字符串</p> <p>strcpy()</p> <p>strncpy() //复制字符串本身</p> <h3 id="字符串示例"><a href="#字符串示例" class="header-anchor">#</a> 字符串示例</h3> <h3 id="ctype-h-字符函数"><a href="#ctype-h-字符函数" class="header-anchor">#</a> ctype.h 字符函数</h3> <p>用于处理字符</p> <h3 id="命令行参数"><a href="#命令行参数" class="header-anchor">#</a> 命令行参数</h3> <p>使用命令行运行程序时可以在同一行添加参数</p> <p>程序通过main()的参数读取这些参数，</p> <div class="language-C extra-class"><pre class="language-c"><code><span class="token comment">/* repeat.c -- 带参数的 main() */</span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h&gt;</span></span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> cahr <span class="token operator">*</span>argv <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">int</span> count<span class="token punctuation">;</span>

    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;The command line has %d arguments:\n&quot;</span><span class="token punctuation">,</span> argc <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>count <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> count <span class="token operator">&lt;</span> argc<span class="token operator">:</span> count<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;%d: %s\n&quot;</span><span class="token punctuation">,</span> count<span class="token punctuation">,</span> argv<span class="token punctuation">[</span>count<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>该程序编译为可执行文件 repeat。下面是通过命令行运行该程序后的输出：</p> <div class="language-sh extra-class"><pre class="language-sh"><code>C<span class="token operator">&gt;</span>repeat Resistance is futile
The <span class="token builtin class-name">command</span> line has %d arguments:
<span class="token number">1</span>: Resistance
<span class="token number">2</span>: is
<span class="token number">3</span>: futile
</code></pre></div><h3 id="把字符串转换成数字"><a href="#把字符串转换成数字" class="header-anchor">#</a> 把字符串转换成数字</h3> <p>atoi()S</p> <h2 id="ch12-存储类别、链接和内存管理"><a href="#ch12-存储类别、链接和内存管理" class="header-anchor">#</a> Ch12 存储类别、链接和内存管理</h2> <p>C提供了多种存储类别在内存中存储数据。</p> <h3 id="存储类别"><a href="#存储类别" class="header-anchor">#</a> 存储类别</h3> <ol><li>作用域</li></ol> <p>作用域描述程序中可访问标识符的区域。</p> <p>作用域有：块作用域，函数作用域，函数原型作用域或文件作用域。</p> <p>块作用域：声明在语句块中的变量，在语句块内可见</p> <p>函数作用域：：声明在函数中的变量，函数体内可见</p> <p>函数原型作用域：仅仅在函数原型的那个括号（）里面可见。</p> <p>文件作用域： 变量定义在函数的外面，从定义到文件末尾可见</p> <ol start="2"><li>链接</li></ol> <p>C变量有3种链接属性：外部链接、内部链接和无链接。块作用域、函数作用域和函数原型作用域的变量都是无链接变量。</p> <p>具有文件作用域的变量可以时外部链接或内部链接，外部链接可在多文件程序中使用，内部链接只能在当前单元使用。</p> <p>存储类别说明符 <code>static</code> 可区分内部链接和外部链接：</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">int</span> a <span class="token operator">=</span> <span class="token number">6</span><span class="token punctuation">;</span> <span class="token comment">//外部链接</span>
<span class="token keyword">static</span> <span class="token keyword">int</span> b <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span> <span class="token comment">//内部链接</span>
</code></pre></div><ol start="3"><li>存储期</li></ol> <p>存储期描述了对象的生存期。</p> <p>C对象有4种存储期：静态存储期、线程存储期、自动存储期、动态分配存储期。</p> <p>静态存储期： 静态存储期的对象在程序执行期间一直存在。文件作用域变量具有静态存储期。</p> <p>线程存储期：用于并发程序设计，程序执行可分为多个线程。具有线程存储期的对象，从被声明至线程结束期间存在。</p> <p>以关键字 <code>_Thread_local</code> 声明一个对象时，每个线程都获得该变量的私有备份。</p> <p>自动存储期：块作用域变量通常具有自动存储期。内存自动分配和释放。 块作用域变量在前面加上 static 可以变长静态存储期。</p> <ol start="4"><li>自动变量</li></ol> <p>默认 块或函数头种的变量都是自动存储类。</p> <p>可以用auto 显式定义自动变量：auto int plox; //一般不需要，且和C++的auto不同，有歧义。</p> <ol><li>没有花括号的块</li></ol> <p>循环或if语句的一部分，即使没有{},也是一个块。</p> <ol start="2"><li>自动变量的初始化</li></ol> <p>自动变量不会自己初始化。</p> <ol start="5"><li>寄存器变量 (register)</li></ol> <p>为了加快计算速度把变量存在寄存器中，通常不需要</p> <ol start="6"><li><p>块作用域的静态变量</p></li> <li><p>外部链接的静态变量</p></li> <li><p>内部链接的静态变量</p></li> <li><p>多文件</p></li> <li><p>存储类别说明符</p></li> <li><p>存储类别和函数'static double beta(int ,int);</p></li> <li><p>存储类别的选择：按需选择，通常自动</p></li></ol> <h3 id="随机数函数和静态变量"><a href="#随机数函数和静态变量" class="header-anchor">#</a> 随机数函数和静态变量</h3> <h3 id="掷骰子"><a href="#掷骰子" class="header-anchor">#</a> 掷骰子</h3> <h2 id="ch13-文件输入-输出"><a href="#ch13-文件输入-输出" class="header-anchor">#</a> Ch13 文件输入/输出</h2> <h3 id="与文件进行通信"><a href="#与文件进行通信" class="header-anchor">#</a> 与文件进行通信</h3> <ol><li>文件是什么</li></ol> <p>C把文件看作是一系列连续的字节。C提供两种文件模式：文本模式和二进制模式。</p> <ol start="2"><li><p>文本模式和二进制模式</p></li> <li><p>I/O的级别</p></li> <li><p>标准文件</p></li></ol> <p>C程序会自动打开3个文件：标准输入，标准输出和标准错误输出。</p> <h3 id="标准i-o"><a href="#标准i-o" class="header-anchor">#</a> 标准I/O</h3> <details class="custom-block details"><summary>Check</summary> <div class="language-c extra-class"><pre class="language-c"><code><span class="token comment">/*count.c */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> _CRT_SECURE_NO_WARNINGS</span>
<span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;stdio.h&gt;</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;stdlib.h&gt;</span>  </span><span class="token comment">//提供exit()函数</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">char</span><span class="token operator">*</span> argv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">int</span> ch<span class="token punctuation">;</span>
	FILE <span class="token operator">*</span>fp<span class="token punctuation">;</span> <span class="token comment">//文件指针</span>
	<span class="token keyword">unsigned</span> <span class="token keyword">long</span> count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>argc <span class="token operator">!=</span> <span class="token number">2</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;Usage: %s filename\n&quot;</span><span class="token punctuation">,</span> argv<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">exit</span><span class="token punctuation">(</span>EXIT_FAILURE<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>fp <span class="token operator">=</span> <span class="token function">fopen</span><span class="token punctuation">(</span>argv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">&quot;r&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;Can't open %s\n&quot;</span><span class="token punctuation">,</span> argv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">exit</span><span class="token punctuation">(</span>EXIT_FAILURE<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>ch <span class="token operator">=</span> <span class="token function">getc</span><span class="token punctuation">(</span>fp<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token constant">EOF</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token function">putc</span><span class="token punctuation">(</span>ch<span class="token punctuation">,</span> <span class="token constant">stdout</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		count<span class="token operator">++</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token function">fclose</span><span class="token punctuation">(</span>fp<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;\nFile %s has %lu characters\n&quot;</span><span class="token punctuation">,</span> argv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> count<span class="token punctuation">)</span><span class="token punctuation">;</span>
 
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
 
<span class="token punctuation">}</span>
</code></pre></div></details> <ol><li><p>检查命令行参数</p></li> <li><p><code>fopen()</code> 函数程序使用 <code>fopen()</code> 函数打开文件，（函数声明在stdio.h)。</p></li></ol> <p>fopen()的第一个参数是待打开文件的名称，第2个参数是一个字符串，指定打开文件的模式（见f表open()的模式字符串）。</p> <p>fopen()的返回值是一个文件指针（file pointer），文件指针的类型是指向FILE的指针（FILE定义在stdio.h中）</p> <p>表 13.1 fopen()的模式字符串</p> <table><thead><tr><th style="text-align:left;">模式字符串</th> <th style="text-align:left;">含义</th></tr></thead> <tbody><tr><td style="text-align:left;">&quot;r&quot;</td> <td style="text-align:left;">以读模式打开文件</td></tr> <tr><td style="text-align:left;">&quot;w&quot;</td> <td style="text-align:left;"></td></tr> <tr><td style="text-align:left;">&quot;a&quot;</td> <td style="text-align:left;"></td></tr> <tr><td style="text-align:left;">&quot;r+&quot;</td> <td style="text-align:left;"></td></tr> <tr><td style="text-align:left;">&quot;w+&quot;</td> <td style="text-align:left;"></td></tr> <tr><td style="text-align:left;">&quot;a+&quot;</td> <td style="text-align:left;"></td></tr> <tr><td style="text-align:left;">&quot;rb&quot;、&quot;wb&quot;、&quot;ab&quot;、&quot;ab+&quot;、&quot;a+b&quot;、&quot;wb+&quot;、&quot;w+b&quot;、&quot;ab+&quot;、&quot;a+b&quot;</td> <td style="text-align:left;"></td></tr> <tr><td style="text-align:left;">&quot;wx&quot;、&quot;wbx&quot;、&quot;w+x&quot;、&quot;wb+x&quot;或&quot;w+bx&quot;</td> <td style="text-align:left;"></td></tr></tbody></table> <ol start="3"><li>getc()和putc()函数</li></ol> <p>类似与getchar()，但getc()是从文件中获取一个字符。</p> <p>ch = getc(fp); //fp是FILE类型的指针。</p> <p>putc()是将字符放在指针指向的文件中：</p> <p>putc(ch, fp);</p> <ol start="4"><li>文件结尾</li></ol> <p>如果getc()读取字符数发现它是文件结尾，它会返回一个值“EOF&quot;。</p> <ol start="5"><li>fclose()函数</li></ol> <p>fclose(fp)函数关闭fp指定的文件。</p> <p>成功关闭时返回0，否则返回EOF。借此可以检测文件是否成功关闭：</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">fclose</span><span class="token punctuation">(</span>fp<span class="token punctuation">)</span><span class="token operator">!=</span><span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;Error in closeing file \n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ol start="6"><li>指向标准文件的指针</li></ol> <p>表 — 标准文件和相关联的文件指针</p> <table><thead><tr><th style="text-align:left;">标准文件</th> <th style="text-align:left;">文件指针</th> <th style="text-align:left;">通常使用的设备</th></tr></thead> <tbody><tr><td style="text-align:left;">标准输入</td> <td style="text-align:left;">stdin</td> <td style="text-align:left;">键盘</td></tr> <tr><td style="text-align:left;">标准输出</td> <td style="text-align:left;">stdout</td> <td style="text-align:left;">显示器</td></tr> <tr><td style="text-align:left;">标准错误</td> <td style="text-align:left;">stderr</td> <td style="text-align:left;">显示器</td></tr></tbody></table> <h3 id="一个简单的文件压缩程序"><a href="#一个简单的文件压缩程序" class="header-anchor">#</a> 一个简单的文件压缩程序</h3> <p>（将某个文本文件的内容”压缩“，压缩方法是每3个字符只保留第一个，剩下两个丢弃）</p> <details class="custom-block details"><summary>Check</summary> <div class="language-c extra-class"><pre class="language-c"><code><span class="token comment">//reducto.c</span>
<span class="token macro property">#<span class="token directive keyword">define</span> _CRT_SECURE_NO_WARNINGS</span>
<span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;stdio.h&gt;</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;stdlib.h&gt;</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;string.h&gt;</span></span>
<span class="token macro property">#<span class="token directive keyword">define</span> LEN 40</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span> argv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	FILE <span class="token operator">*</span> in<span class="token punctuation">,</span> <span class="token operator">*</span>out<span class="token punctuation">;</span>
	<span class="token keyword">int</span> ch<span class="token punctuation">;</span>
	<span class="token keyword">char</span> name<span class="token punctuation">[</span>LEN<span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
 
	<span class="token keyword">if</span> <span class="token punctuation">(</span>argc <span class="token operator">&lt;</span> <span class="token number">2</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token constant">stderr</span><span class="token punctuation">,</span> <span class="token string">&quot;Usage: %s filename\n&quot;</span><span class="token punctuation">,</span> argv<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">exit</span><span class="token punctuation">(</span>EXIT_FAILURE<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token comment">//设置输入</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>in <span class="token operator">=</span> <span class="token function">fopen</span><span class="token punctuation">(</span>argv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">&quot;r&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token constant">stderr</span><span class="token punctuation">,</span> <span class="token string">&quot;I couldn't open the file \&quot;%s\&quot;\n &quot;</span><span class="token punctuation">,</span> argv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">exit</span><span class="token punctuation">(</span>EXIT_FAILURE<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token comment">//设置输出</span>
	<span class="token function">strncpy</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> argv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> LEN <span class="token operator">-</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 拷贝文件名</span>
	name<span class="token punctuation">[</span>LEN <span class="token operator">-</span> <span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'\0'</span><span class="token punctuation">;</span>
	<span class="token function">strcat</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> <span class="token string">&quot;.red&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>out <span class="token operator">=</span> <span class="token function">fopen</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> <span class="token string">&quot;w&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token constant">stderr</span><span class="token punctuation">,</span> <span class="token string">&quot;Can't create output file.\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token comment">//拷贝数据</span>
	<span class="token keyword">while</span> <span class="token punctuation">(</span> <span class="token punctuation">(</span>ch<span class="token operator">=</span><span class="token function">getc</span><span class="token punctuation">(</span>in<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">!=</span><span class="token constant">EOF</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>count<span class="token operator">++</span> <span class="token operator">%</span> <span class="token number">3</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
			<span class="token function">putc</span><span class="token punctuation">(</span>ch<span class="token punctuation">,</span> out<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">fclose</span><span class="token punctuation">(</span>in<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span> <span class="token operator">||</span> <span class="token function">fclose</span><span class="token punctuation">(</span>out<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
		<span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token constant">stderr</span><span class="token punctuation">,</span> <span class="token string">&quot;Error in closing files.\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></details> <h3 id="文件i-o：fprintf-、fscanf-、fgets-、fputs"><a href="#文件i-o：fprintf-、fscanf-、fgets-、fputs" class="header-anchor">#</a> 文件I/O：fprintf()、fscanf()、fgets()、fputs()</h3> <details class="custom-block details"><summary>Check</summary> <div class="language-c extra-class"><pre class="language-c"><code><span class="token comment">/*addaword.c --fprintf() fscanf() rewind()*/</span>
<span class="token macro property">#<span class="token directive keyword">define</span> _CRT_SECURE_NO_WARNINGS</span>
<span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;stdio.h&gt;</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;stdlib.h&gt;</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;string.h&gt;</span></span>
<span class="token macro property">#<span class="token directive keyword">define</span> MAX 41</span>
 
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	FILE <span class="token operator">*</span>fp<span class="token punctuation">;</span>
	<span class="token keyword">char</span> words<span class="token punctuation">[</span>MAX<span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>fp <span class="token operator">=</span> <span class="token function">fopen</span><span class="token punctuation">(</span><span class="token string">&quot;wordy&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;a+&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token constant">stdout</span><span class="token punctuation">,</span> <span class="token string">&quot;Can't open \&quot;wordy\&quot; file.\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">exit</span><span class="token punctuation">(</span>EXIT_FAILURE<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">&quot;Enter words to add to the file; press the #&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">&quot;key at the beginning of a line to terminate.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">fscanf</span><span class="token punctuation">(</span><span class="token constant">stdin</span><span class="token punctuation">,</span> <span class="token string">&quot;%40s&quot;</span><span class="token punctuation">,</span> words<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>words<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token string">'#'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
		<span class="token function">fprintf</span><span class="token punctuation">(</span>fp<span class="token punctuation">,</span> <span class="token string">&quot;%s\n&quot;</span><span class="token punctuation">,</span> words<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">&quot;File contents:&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">rewind</span><span class="token punctuation">(</span>fp<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//回到文件开始处。</span>
	<span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token function">fscanf</span><span class="token punctuation">(</span>fp<span class="token punctuation">,</span> <span class="token string">&quot;%s&quot;</span><span class="token punctuation">,</span> words<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span>
		<span class="token function">puts</span><span class="token punctuation">(</span>words<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">&quot;Done!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">fclose</span><span class="token punctuation">(</span>fp<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
		<span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token constant">stderr</span><span class="token punctuation">,</span> <span class="token string">&quot;Error closing file\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></details> <h3 id="随机访问：fseek-和ftell"><a href="#随机访问：fseek-和ftell" class="header-anchor">#</a> 随机访问：fseek()和ftell()</h3> <p>有了 <code>fseek()</code> 函数，便可把文件看作时数组，移动到文件的任意字节处。</p> <p><code>ftell()</code> 函数返回一个 <code>long</code> 类型的值，表示文件中的当前位置。</p> <h3 id="标准i-o-的机理"><a href="#标准i-o-的机理" class="header-anchor">#</a> 标准I/O 的机理</h3> <h3 id="其他标准i-o函数"><a href="#其他标准i-o函数" class="header-anchor">#</a> 其他标准I/O函数</h3> <h2 id="ch14-结构和其他数据形式"><a href="#ch14-结构和其他数据形式" class="header-anchor">#</a> Ch14 结构和其他数据形式</h2> <h3 id="示例问题：创建图书目录"><a href="#示例问题：创建图书目录" class="header-anchor">#</a> 示例问题：创建图书目录</h3> <p>一本书有多种信息，书名，作者，页数，价格等等，这些信息有的是字符串，有的是浮点数。</p> <p>需要一种既有字符串，又有浮点数的数据形式————C结构。</p> <details class="custom-block details"><summary>Check</summary> <div class="language-c extra-class"><pre class="language-c"><code><span class="token macro property">#<span class="token directive keyword">define</span> _CRT_SECURE_NO_WARNINGS</span>
<span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;stdio.h&gt;</span></span>
<span class="token macro property">#<span class="token directive keyword">define</span> LEN 20</span>
<span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span> msgs<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">=</span>
<span class="token punctuation">{</span>
	<span class="token string">&quot; Thank you for the wonderful evening, &quot;</span><span class="token punctuation">,</span>
	<span class="token string">&quot;You certainly prove that a &quot;</span><span class="token punctuation">,</span>
	<span class="token string">&quot;is a special kind of guy. We must get together&quot;</span><span class="token punctuation">,</span>
	<span class="token string">&quot;over a delicious &quot;</span><span class="token punctuation">,</span>
	<span class="token string">&quot; and have a few laughs&quot;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">struct</span> <span class="token class-name">names</span> <span class="token punctuation">{</span>
	<span class="token keyword">char</span> first<span class="token punctuation">[</span>LEN<span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token keyword">char</span> last<span class="token punctuation">[</span>LEN<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
 
<span class="token keyword">struct</span> <span class="token class-name">guy</span> <span class="token punctuation">{</span>
	<span class="token keyword">struct</span> <span class="token class-name">names</span> handle<span class="token punctuation">;</span>  <span class="token comment">//嵌套结构，结构里包含另一个结构</span>
	<span class="token keyword">char</span> favfood<span class="token punctuation">[</span>LEN<span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token keyword">char</span> job<span class="token punctuation">[</span>LEN<span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token keyword">float</span> income<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
 
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">struct</span> <span class="token class-name">guy</span> fellow <span class="token operator">=</span> <span class="token punctuation">{</span>
		<span class="token punctuation">{</span><span class="token string">&quot;Ewen&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Villard&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token string">&quot;grilled salmon&quot;</span><span class="token punctuation">,</span>
		<span class="token string">&quot;personality coach&quot;</span><span class="token punctuation">,</span>
		<span class="token number">68112.00</span>
	<span class="token punctuation">}</span><span class="token punctuation">;</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;Dear %s,\n\n&quot;</span><span class="token punctuation">,</span> fellow<span class="token punctuation">.</span>handle<span class="token punctuation">.</span>first<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//使用嵌套结构，先使用.得到name，再.得到first</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;%s%s.\n&quot;</span><span class="token punctuation">,</span> msgs<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> fellow<span class="token punctuation">.</span>handle<span class="token punctuation">.</span>first<span class="token punctuation">)</span><span class="token punctuation">;</span> 
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;%s%s\n&quot;</span><span class="token punctuation">,</span> msgs<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> fellow<span class="token punctuation">.</span>job<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;%s\n&quot;</span><span class="token punctuation">,</span> msgs<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;%s%s%s&quot;</span><span class="token punctuation">,</span> msgs<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> fellow<span class="token punctuation">.</span>favfood<span class="token punctuation">,</span> msgs<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>fellow<span class="token punctuation">.</span>income <span class="token operator">&gt;</span> <span class="token number">150000.0</span><span class="token punctuation">)</span>
		<span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">&quot;!!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>fellow<span class="token punctuation">.</span>income <span class="token operator">&gt;</span> <span class="token number">75000.0</span><span class="token punctuation">)</span>
		<span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">&quot;!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">else</span>
		<span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">&quot;.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;\n%40s%s\n&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot; &quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;See you soon,&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;%40s%s\n&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot; &quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Shalala&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></details> <h3 id="建立结构声明"><a href="#建立结构声明" class="header-anchor">#</a> 建立结构声明</h3> <p>结构声明 (<em>structure declaration</em>) 描述一个结构的组织布局，声明类似：</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">struct</span> <span class="token class-name">book</span> <span class="token punctuation">{</span>            
    <span class="token keyword">char</span> title<span class="token punctuation">[</span>MAXTITL<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">char</span> author<span class="token punctuation">[</span>MAXAUTL<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">float</span> value<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="定义结构变量"><a href="#定义结构变量" class="header-anchor">#</a> 定义结构变量</h3> <p>程序中关键结构变量：</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">struct</span> <span class="token class-name">book</span> library<span class="token punctuation">;</span>
</code></pre></div><p>编译器在这里创建一个结构变量library，为其分配内存空间。</p> <ol><li>初始化结构</li></ol> <p>和初始化数组类似：</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">struct</span> <span class="token class-name">book</span> library <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token string">&quot;The ...&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Renee Vivotte&quot;</span><span class="token punctuation">,</span> <span class="token number">1.95</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><ol start="2"><li>访问结构成员</li></ol> <p>使用结构成员运算符 <code>.</code> 来访问结构中的成员。如：用 library.value 访问 library 的 value</p> <ol start="3"><li>结构的初始化器</li></ol> <p>C99和C11为结构提供了指定初始化器 (<em>designated initializer</em>)，语法和数组的指定初始化器类似。</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">struct</span> <span class="token class-name">book</span> surprise <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token number">10.99</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="结构数组"><a href="#结构数组" class="header-anchor">#</a> 结构数组</h3> <p>同样是那个图书问题，一本书用 <strong>结构</strong> 可以解决。</p> <p>如果我们有很多本图书，就可以用 <strong>结构数组</strong> 了。</p> <details class="custom-block details"><summary>Check</summary> <div class="language-c extra-class"><pre class="language-c"><code><span class="token macro property">#<span class="token directive keyword">define</span> _CRT_SECURE_NO_WARNINGS</span>
<span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;stdio.h&gt;</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;string.h&gt;</span></span>
<span class="token keyword">char</span> <span class="token operator">*</span> <span class="token function">s_gets</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span>st<span class="token punctuation">,</span> <span class="token keyword">int</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token macro property">#<span class="token directive keyword">define</span> MAXTITL 40</span>
<span class="token macro property">#<span class="token directive keyword">define</span> MAXAUTL 40</span>
<span class="token macro property">#<span class="token directive keyword">define</span> MAXBOOKS 100</span>
<span class="token macro property">#<span class="token directive keyword">define</span> _CRT_SECURE_NO_WARNINGS</span>
 
<span class="token keyword">struct</span> <span class="token class-name">book</span> <span class="token punctuation">{</span>			<span class="token comment">//	结构模板，标记是book</span>
	<span class="token keyword">char</span> title<span class="token punctuation">[</span>MAXTITL<span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token keyword">char</span> author<span class="token punctuation">[</span>MAXAUTL<span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token keyword">float</span> value<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
 
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">struct</span> <span class="token class-name">book</span> library<span class="token punctuation">[</span>MAXBOOKS<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">//声明struct book 类型变量 library</span>
	<span class="token keyword">int</span> count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> index<span class="token punctuation">;</span>
 
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;Please enter the book title.\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;Enter at the start of a line to stop.\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">while</span> <span class="token punctuation">(</span>count <span class="token operator">&lt;</span> MAXBOOKS <span class="token operator">&amp;&amp;</span> <span class="token function">s_gets</span><span class="token punctuation">(</span>library<span class="token punctuation">[</span>count<span class="token punctuation">]</span><span class="token punctuation">.</span>title<span class="token punctuation">,</span> MAXTITL<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token constant">NULL</span>
		<span class="token operator">&amp;&amp;</span> library<span class="token punctuation">[</span>count<span class="token punctuation">]</span><span class="token punctuation">.</span>title<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token string">'\0'</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;Now enter the anthor.\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">s_gets</span><span class="token punctuation">(</span>library<span class="token punctuation">[</span>count<span class="token punctuation">]</span><span class="token punctuation">.</span>author<span class="token punctuation">,</span> MAXAUTL<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;Now enter the value.\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">&quot;%f&quot;</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>library<span class="token punctuation">[</span>count<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token string">'\n'</span><span class="token punctuation">)</span>
			<span class="token keyword">continue</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>count <span class="token operator">&lt;</span> MAXBOOKS<span class="token punctuation">)</span>
			<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;Enter the next title.\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>count <span class="token operator">&gt;</span><span class="token number">0</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;Here is the list of your books:\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">for</span> <span class="token punctuation">(</span>index <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> index <span class="token operator">&lt;</span> count<span class="token punctuation">;</span> index<span class="token operator">++</span><span class="token punctuation">)</span>
			<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;%s by %s: $%.2f\n&quot;</span><span class="token punctuation">,</span> library<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">.</span>title<span class="token punctuation">,</span>
				library<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">.</span>author<span class="token punctuation">,</span> library<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">else</span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;No books?\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
 
<span class="token keyword">char</span> <span class="token operator">*</span> <span class="token function">s_gets</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span> st<span class="token punctuation">,</span> <span class="token keyword">int</span> n<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">char</span> <span class="token operator">*</span> ret_val<span class="token punctuation">;</span>
	<span class="token keyword">char</span> <span class="token operator">*</span> find<span class="token punctuation">;</span>
	ret_val <span class="token operator">=</span> <span class="token function">fgets</span><span class="token punctuation">(</span>st<span class="token punctuation">,</span> n<span class="token punctuation">,</span> <span class="token constant">stdin</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>ret_val<span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		find <span class="token operator">=</span> <span class="token function">strchr</span><span class="token punctuation">(</span>st<span class="token punctuation">,</span> <span class="token string">'\n'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//查找换行符</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>find<span class="token punctuation">)</span>
			<span class="token operator">*</span>find <span class="token operator">=</span> <span class="token string">'\0'</span><span class="token punctuation">;</span> <span class="token comment">//将换行符换成'\0'</span>
		<span class="token keyword">else</span>
			<span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token string">'\n'</span><span class="token punctuation">)</span>  <span class="token comment">//处理输入行剩余的字符</span>
				<span class="token keyword">continue</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span> ret_val<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></details> <ol><li>声明结构数组</li></ol> <p>和其他类型的数组类似</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">int</span> a<span class="token punctuation">[</span><span class="token number">100</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">struct</span> <span class="token class-name">book</span> library<span class="token punctuation">[</span>MAXBOOK<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">//这里只是把 int 类型换成 struct book 类型。</span>
</code></pre></div><ol start="2"><li>标识结构数组的成员</li></ol> <p>在结构名后面使用点 <code>.</code> 运算符</p> <div class="language-c extra-class"><pre class="language-c"><code>library<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>balue
</code></pre></div><ol start="3"><li>程序讨论</li></ol> <h3 id="嵌套结构"><a href="#嵌套结构" class="header-anchor">#</a> 嵌套结构</h3> <p>结构内包含另一个结构。</p> <details class="custom-block details"><summary>Check</summary> <div class="language-c extra-class"><pre class="language-c"><code><span class="token macro property">#<span class="token directive keyword">define</span> _CRT_SECURE_NO_WARNINGS</span>
<span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;stdio.h&gt;</span></span>
<span class="token macro property">#<span class="token directive keyword">define</span> LEN 20</span>
<span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span> msgs<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">=</span>
<span class="token punctuation">{</span>
	<span class="token string">&quot; Thank you for the wonderful evening, &quot;</span><span class="token punctuation">,</span>
	<span class="token string">&quot;You certainly prove that a &quot;</span><span class="token punctuation">,</span>
	<span class="token string">&quot;is a special kind of guy. We must get together&quot;</span><span class="token punctuation">,</span>
	<span class="token string">&quot;over a delicious &quot;</span><span class="token punctuation">,</span>
	<span class="token string">&quot; and have a few laughs&quot;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">struct</span> <span class="token class-name">names</span> <span class="token punctuation">{</span>
	<span class="token keyword">char</span> first<span class="token punctuation">[</span>LEN<span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token keyword">char</span> last<span class="token punctuation">[</span>LEN<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
 
<span class="token keyword">struct</span> <span class="token class-name">guy</span> <span class="token punctuation">{</span>
	<span class="token keyword">struct</span> <span class="token class-name">names</span> handle<span class="token punctuation">;</span>  <span class="token comment">//嵌套结构，结构里包含另一个结构</span>
	<span class="token keyword">char</span> favfood<span class="token punctuation">[</span>LEN<span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token keyword">char</span> job<span class="token punctuation">[</span>LEN<span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token keyword">float</span> income<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
 
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">struct</span> <span class="token class-name">guy</span> fellow <span class="token operator">=</span> <span class="token punctuation">{</span>
		<span class="token punctuation">{</span><span class="token string">&quot;Ewen&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Villard&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token string">&quot;grilled salmon&quot;</span><span class="token punctuation">,</span>
		<span class="token string">&quot;personality coach&quot;</span><span class="token punctuation">,</span>
		<span class="token number">68112.00</span>
	<span class="token punctuation">}</span><span class="token punctuation">;</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;Dear %s,\n\n&quot;</span><span class="token punctuation">,</span> fellow<span class="token punctuation">.</span>handle<span class="token punctuation">.</span>first<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//使用嵌套结构，先使用.得到name，再.得到first</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;%s%s.\n&quot;</span><span class="token punctuation">,</span> msgs<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> fellow<span class="token punctuation">.</span>handle<span class="token punctuation">.</span>first<span class="token punctuation">)</span><span class="token punctuation">;</span> 
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;%s%s\n&quot;</span><span class="token punctuation">,</span> msgs<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> fellow<span class="token punctuation">.</span>job<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;%s\n&quot;</span><span class="token punctuation">,</span> msgs<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;%s%s%s&quot;</span><span class="token punctuation">,</span> msgs<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> fellow<span class="token punctuation">.</span>favfood<span class="token punctuation">,</span> msgs<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>fellow<span class="token punctuation">.</span>income <span class="token operator">&gt;</span> <span class="token number">150000.0</span><span class="token punctuation">)</span>
		<span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">&quot;!!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>fellow<span class="token punctuation">.</span>income <span class="token operator">&gt;</span> <span class="token number">75000.0</span><span class="token punctuation">)</span>
		<span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">&quot;!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">else</span>
		<span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">&quot;.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;\n%40s%s\n&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot; &quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;See you soon,&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;%40s%s\n&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot; &quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Shalala&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></details> <h3 id="指向结构的指针"><a href="#指向结构的指针" class="header-anchor">#</a> 指向结构的指针</h3> <details class="custom-block details"><summary>Check</summary> <div class="language-c extra-class"><pre class="language-c"><code><span class="token comment">/*friends.c --使用指向结构的指针*/</span>
<span class="token macro property">#<span class="token directive keyword">define</span> _CRT_SECURE_NO_WARNINGS</span>
<span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;stdio.h&gt;</span></span>
<span class="token macro property">#<span class="token directive keyword">define</span> LEN 20</span>
 
<span class="token keyword">struct</span> <span class="token class-name">names</span> <span class="token punctuation">{</span>
	<span class="token keyword">char</span> first<span class="token punctuation">[</span>LEN<span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token keyword">char</span> last<span class="token punctuation">[</span>LEN<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
 
<span class="token keyword">struct</span> <span class="token class-name">guy</span> <span class="token punctuation">{</span>
	<span class="token keyword">struct</span> <span class="token class-name">names</span> handle<span class="token punctuation">;</span>
	<span class="token keyword">char</span> favfood<span class="token punctuation">[</span>LEN<span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token keyword">char</span> job<span class="token punctuation">[</span>LEN<span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token keyword">float</span> income<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
 
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">struct</span> <span class="token class-name">guy</span> fellow<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span><span class="token punctuation">{</span> 
		<span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token string">&quot;Ewen&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Villard&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token string">&quot;grilled salmon&quot;</span><span class="token punctuation">,</span>
		<span class="token string">&quot;personality coach&quot;</span><span class="token punctuation">,</span>
		<span class="token number">68112.00</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token string">&quot;Rodney&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;Swillbelly&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
		 <span class="token string">&quot;tripe&quot;</span><span class="token punctuation">,</span>
		 <span class="token string">&quot;tabloid editor&quot;</span><span class="token punctuation">,</span>
		 <span class="token number">432400.00</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token punctuation">;</span>
	<span class="token keyword">struct</span> <span class="token class-name">guy</span> <span class="token operator">*</span> him<span class="token punctuation">;</span> <span class="token comment">//指向结构的指针</span>
 
 
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;address #1:%p #2: %p\n&quot;</span><span class="token punctuation">,</span><span class="token operator">&amp;</span>fellow<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token operator">&amp;</span>fellow<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	him <span class="token operator">=</span> <span class="token operator">&amp;</span>fellow<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;pointer#1:%p #2: %p\n&quot;</span><span class="token punctuation">,</span> him<span class="token punctuation">,</span> him <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;him-&gt;income is $%.2f: (*him).income is $%.2f\n&quot;</span><span class="token punctuation">,</span>
		him<span class="token operator">-&gt;</span>income<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token operator">*</span>him<span class="token punctuation">)</span><span class="token punctuation">.</span>income<span class="token punctuation">)</span><span class="token punctuation">;</span>
	him<span class="token operator">++</span><span class="token punctuation">;</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;him-&gt;favfood is %s: him-&gt;handler.last is %s\n&quot;</span><span class="token punctuation">,</span>
		him<span class="token operator">-&gt;</span>favfood<span class="token punctuation">,</span> him<span class="token operator">-&gt;</span>handle<span class="token punctuation">.</span>last<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
 
<span class="token punctuation">}</span>
</code></pre></div></details> <ol><li>声明和初始化结构指针</li></ol> <p>声明结构指针：//和其他指针类似</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">struct</span> <span class="token class-name">guy</span> <span class="token operator">*</span> him<span class="token punctuation">;</span>
</code></pre></div><p>barney是一个guy类型的结构：可以这样给指针赋值：</p> <div class="language-c extra-class"><pre class="language-c"><code>him <span class="token operator">=</span> <span class="token operator">&amp;</span>barney<span class="token punctuation">;</span>
</code></pre></div><ol start="2"><li>用指针访问成员</li></ol> <p>方法1：指针-&gt;成员    如：</p> <div class="language-c extra-class"><pre class="language-c"><code>him<span class="token operator">-&gt;</span>income
</code></pre></div><p>方法2：(*指针).成员  如：</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token punctuation">(</span><span class="token operator">*</span>him<span class="token punctuation">)</span><span class="token punctuation">.</span>income
</code></pre></div><h3 id="向函数传递结构的信息"><a href="#向函数传递结构的信息" class="header-anchor">#</a> 向函数传递结构的信息</h3> <ol><li>传递结构成员</li></ol> <p>传递结构成员给函数和传递普通变量给函数并没有什么不同。</p> <details class="custom-block details"><summary>Check</summary> <div class="language-c extra-class"><pre class="language-c"><code><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;stdio.h&gt;</span></span>
<span class="token macro property">#<span class="token directive keyword">define</span> FUNDLEN 50</span>
 
<span class="token keyword">struct</span> <span class="token class-name">funds</span> <span class="token punctuation">{</span>
	<span class="token keyword">char</span> bank<span class="token punctuation">[</span>FUNDLEN<span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token keyword">double</span> bankfund<span class="token punctuation">;</span>
	<span class="token keyword">char</span> save<span class="token punctuation">[</span>FUNDLEN<span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token keyword">double</span> savefund<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
 
<span class="token keyword">double</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token keyword">double</span><span class="token punctuation">,</span> <span class="token keyword">double</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">struct</span> <span class="token class-name">funds</span> stan <span class="token operator">=</span> <span class="token punctuation">{</span>
		<span class="token string">&quot;Garlic--Melon Bank&quot;</span><span class="token punctuation">,</span>
		<span class="token number">4032.27</span><span class="token punctuation">,</span>
		<span class="token string">&quot;Lucky's Savings and Loan&quot;</span><span class="token punctuation">,</span>
		<span class="token number">8543.94</span>
	<span class="token punctuation">}</span><span class="token punctuation">;</span>
 
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;Stan has a total of $%.2f.\n&quot;</span><span class="token punctuation">,</span><span class="token function">sum</span><span class="token punctuation">(</span>stan<span class="token punctuation">.</span>bankfund<span class="token punctuation">,</span>stan<span class="token punctuation">.</span>savefund<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">double</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token keyword">double</span> x<span class="token punctuation">,</span> <span class="token keyword">double</span> y<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token punctuation">(</span>x <span class="token operator">+</span> y<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></details> <ol start="2"><li>传递结构的地址 （结构指针做参数）</li></ol> <details class="custom-block details"><summary>Check</summary> <div class="language-c extra-class"><pre class="language-c"><code><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;stdio.h&gt;</span></span>
<span class="token macro property">#<span class="token directive keyword">define</span> FUNDLEN 50</span>
 
<span class="token keyword">struct</span> <span class="token class-name">funds</span> <span class="token punctuation">{</span>
	<span class="token keyword">char</span> bank<span class="token punctuation">[</span>FUNDLEN<span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token keyword">double</span> bankfund<span class="token punctuation">;</span>
	<span class="token keyword">char</span> save<span class="token punctuation">[</span>FUNDLEN<span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token keyword">double</span> savefund<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
 
<span class="token keyword">double</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">struct</span> <span class="token class-name">funds</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//</span>
 
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">struct</span> <span class="token class-name">funds</span> stan <span class="token operator">=</span> <span class="token punctuation">{</span>
		<span class="token string">&quot;Garlic--Melon Bank&quot;</span><span class="token punctuation">,</span>
		<span class="token number">4032.27</span><span class="token punctuation">,</span>
		<span class="token string">&quot;Lucky's Savings and Loan&quot;</span><span class="token punctuation">,</span>
		<span class="token number">8543.94</span>
	<span class="token punctuation">}</span><span class="token punctuation">;</span>
 
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;Stan has a total of $%.2f.\n&quot;</span><span class="token punctuation">,</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>stan<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">double</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">struct</span> <span class="token class-name">funds</span> <span class="token operator">*</span> money<span class="token punctuation">)</span> <span class="token comment">//</span>
<span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token punctuation">(</span>money<span class="token operator">-&gt;</span>bankfund <span class="token operator">+</span> money<span class="token operator">-&gt;</span>savefund<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></details> <ol start="3"><li>传递结构</li></ol> <p>传递结构是传值，函数将创建一个结构副本，然后把实际参数的值给这个副本，函数中的操作都是对副本进行的。</p> <details class="custom-block details"><summary>Check</summary> <div class="language-c extra-class"><pre class="language-c"><code><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;stdio.h&gt;</span></span>
<span class="token macro property">#<span class="token directive keyword">define</span> FUNDLEN 50</span>
 
<span class="token keyword">struct</span> <span class="token class-name">funds</span> <span class="token punctuation">{</span>
	<span class="token keyword">char</span> bank<span class="token punctuation">[</span>FUNDLEN<span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token keyword">double</span> bankfund<span class="token punctuation">;</span>
	<span class="token keyword">char</span> save<span class="token punctuation">[</span>FUNDLEN<span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token keyword">double</span> savefund<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
 
<span class="token keyword">double</span> <span class="token function">sum</span><span class="token punctuation">(</span> <span class="token keyword">struct</span> <span class="token class-name">funds</span> moolah<span class="token punctuation">)</span><span class="token punctuation">;</span>
 
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">struct</span> <span class="token class-name">funds</span> stan <span class="token operator">=</span> <span class="token punctuation">{</span>
		<span class="token string">&quot;Garlic--Melon Bank&quot;</span><span class="token punctuation">,</span>
		<span class="token number">4032.27</span><span class="token punctuation">,</span>
		<span class="token string">&quot;Lucky's Savings and Loan&quot;</span><span class="token punctuation">,</span>
		<span class="token number">8543.94</span>
	<span class="token punctuation">}</span><span class="token punctuation">;</span>
 
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;Stan has a total of $%.2f.\n&quot;</span><span class="token punctuation">,</span> <span class="token function">sum</span><span class="token punctuation">(</span>stan<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">double</span> <span class="token function">sum</span><span class="token punctuation">(</span> <span class="token keyword">struct</span> <span class="token class-name">funds</span> moolah<span class="token punctuation">)</span>  <span class="token comment">//函数创建一个副本moolah，然后对副本进行操作(不会改变实际参数stan)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">return</span><span class="token punctuation">(</span> moolah<span class="token punctuation">.</span>bankfund <span class="token operator">+</span> moolah<span class="token punctuation">.</span>savefund<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></details> <ol start="4"><li>其他结构特性</li></ol> <p>一个结构可以赋值给另一个结构（数组不行）。</p> <p>神奇的是，如果结构的成员是数组，结构间的赋值仍然可以。</p> <ol start="5"><li>结构和结构指针的选择</li></ol> <p>通常用结构指针作为函数的参数，这样效率较高。如需要防止原始数据被修改，使用const限定符。</p> <ol start="6"><li>结构中的字符数组和字符指针</li></ol> <p>字符数组比较简单。</p> <p>字符指针由于只是给出一个地址，但并未分配内存，可能会存到意外的地方。</p> <ol start="7"><li>结构、指针和malloc()</li></ol> <p>使用malloc()分配内存并使用指针存储该地址。</p> <ol start="8"><li><p>复合字面量和结构（C99）</p></li> <li><p>伸缩型数组成员（C99）</p></li></ol> <ul><li><p>伸缩型数组成员必须是结构的最后一个成员</p></li> <li><p>结构必须至少有一个成员</p></li> <li><p>伸缩数组的声明类似于普通数组，只是它的方括号内是空的。</p></li></ul> <p>例子：</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">struct</span> <span class="token class-name">flex</span><span class="token punctuation">{</span>
    <span class="token keyword">int</span> count<span class="token punctuation">;</span>
    <span class="token keyword">double</span> average<span class="token punctuation">;</span>
    <span class="token keyword">double</span> scores<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">//伸缩型数组成员</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>声明一个 struct flex类型的变量后不能使用scores，因为还没给它分配存储空间。</p> <p>通常使用方法是声明一个struct flex类型的指针，然后用malloc()给它分配存储空间。如：</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">struct</span> <span class="token class-name">flex</span> <span class="token operator">*</span>pf<span class="token punctuation">;</span>
pf <span class="token operator">=</span> <span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">flex</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">5</span><span class="token operator">*</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">double</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ol start="10"><li>匿名结构(C11)</li></ol> <p>C11 中，可以用嵌套的匿名结构进行简化。//但是嵌套结构用处不大</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">struct</span> <span class="token class-name">person</span><span class="token punctuation">{</span>
    <span class="token keyword">int</span> id<span class="token punctuation">;</span>
    <span class="token keyword">struct</span> <span class="token punctuation">{</span> <span class="token keyword">char</span> first<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">char</span> last<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token comment">//匿名结构</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>访问 <strong>first</strong> 时，只需将其看出是 <strong>person</strong> 的成员</p> <div class="language-c extra-class"><pre class="language-c"><code>person ted <span class="token punctuation">;</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
ted<span class="token punctuation">.</span>first<span class="token punctuation">;</span>
</code></pre></div><ol start="11"><li>使用结构数组的函数</li></ol> <details class="custom-block details"><summary>Check</summary> <div class="language-c extra-class"><pre class="language-c"><code><span class="token comment">//把结构数组传递给函数</span>
<span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;stdio.h&gt;</span></span>
<span class="token macro property">#<span class="token directive keyword">define</span> FUNDLEN 50</span>
<span class="token macro property">#<span class="token directive keyword">define</span> N 2</span>
 
<span class="token keyword">struct</span> <span class="token class-name">funds</span> <span class="token punctuation">{</span>
	<span class="token keyword">char</span> bank<span class="token punctuation">[</span>FUNDLEN<span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token keyword">double</span> bankfund<span class="token punctuation">;</span>
	<span class="token keyword">char</span> save<span class="token punctuation">[</span>FUNDLEN<span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token keyword">double</span> savefund<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
 
<span class="token keyword">double</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">struct</span> <span class="token class-name">funds</span> mooey<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">int</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//传入结构数组的函数</span>
 
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">struct</span> <span class="token class-name">funds</span> jones<span class="token punctuation">[</span>N<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
		<span class="token punctuation">{</span>
		<span class="token string">&quot;Garlic--Melon Bank&quot;</span><span class="token punctuation">,</span>
		<span class="token number">4032.27</span><span class="token punctuation">,</span>
		<span class="token string">&quot;Lucky's Savings and Loan&quot;</span><span class="token punctuation">,</span>
		<span class="token number">8543.94</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token punctuation">{</span>
		<span class="token string">&quot;Honest Jack's Bank&quot;</span><span class="token punctuation">,</span>
		<span class="token number">3620.88</span><span class="token punctuation">,</span>
		<span class="token string">&quot;Party Time Savings&quot;</span><span class="token punctuation">,</span>
		<span class="token number">3802.91</span>
<span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token punctuation">;</span>
 
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;The joneses have a total of $%.2f.\n&quot;</span><span class="token punctuation">,</span> <span class="token function">sum</span><span class="token punctuation">(</span>jones<span class="token punctuation">,</span>N<span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">*</span><span class="token comment">//使用sum函数</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">double</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">struct</span> <span class="token class-name">funds</span> money<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token keyword">int</span> n<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">double</span> total<span class="token punctuation">;</span>
	<span class="token keyword">int</span> i<span class="token punctuation">;</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> total <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
		total <span class="token operator">+=</span> money<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>bankfund <span class="token operator">+</span> money<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>savefund<span class="token punctuation">;</span>
	<span class="token keyword">return</span> total<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></details> <h3 id="把结构内容保存到文件中"><a href="#把结构内容保存到文件中" class="header-anchor">#</a> 把结构内容保存到文件中</h3> <p>(&quot;a+b&quot;) 模式打开文件，a+ 可以在文件末尾添加，b 使用二进制文件格式，</p> <p>使用 <code>fread()</code> 和 <code>fwrite()</code> 进行读写。</p> <details class="custom-block details"><summary>Check</summary> <div class="language-c extra-class"><pre class="language-c"><code><span class="token comment">//在文件中保存结构中的内容</span>
<span class="token macro property">#<span class="token directive keyword">define</span> _CRT_SECURE_NO_WARNINGS</span>
<span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;stdio.h&gt;</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;stdlib.h&gt;</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;string.h&gt;</span></span>
<span class="token macro property">#<span class="token directive keyword">define</span> MAXTITL 40</span>
<span class="token macro property">#<span class="token directive keyword">define</span> MAXAULT 40</span>
<span class="token macro property">#<span class="token directive keyword">define</span> MAXBKS  10</span>
<span class="token keyword">char</span> <span class="token operator">*</span> <span class="token function">s_gets</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span> st<span class="token punctuation">,</span> <span class="token keyword">int</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">struct</span> <span class="token class-name">book</span> <span class="token punctuation">{</span>
	<span class="token keyword">char</span> title<span class="token punctuation">[</span>MAXTITL<span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token keyword">char</span> author<span class="token punctuation">[</span>MAXAULT<span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token keyword">float</span> value<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
 
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">struct</span> <span class="token class-name">book</span> library<span class="token punctuation">[</span>MAXBKS<span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> index<span class="token punctuation">,</span> filecount<span class="token punctuation">;</span>
	FILE <span class="token operator">*</span> pbooks<span class="token punctuation">;</span>
	<span class="token keyword">int</span> size <span class="token operator">=</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">book</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>pbooks <span class="token operator">=</span> <span class="token function">fopen</span><span class="token punctuation">(</span><span class="token string">&quot;book.dat&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;a+b&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token function">fputs</span><span class="token punctuation">(</span><span class="token string">&quot;Can't open book.dat file\n&quot;</span><span class="token punctuation">,</span> <span class="token constant">stderr</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token function">rewind</span><span class="token punctuation">(</span>pbooks<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">while</span> <span class="token punctuation">(</span>count<span class="token operator">&lt;</span>MAXBKS <span class="token operator">&amp;&amp;</span> <span class="token function">fread</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>library<span class="token punctuation">[</span>count<span class="token punctuation">]</span><span class="token punctuation">,</span>size<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>pbooks<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>count <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
			<span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">&quot;Current contents of book.dat:&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;%s by %s $%.2f\n&quot;</span><span class="token punctuation">,</span> library<span class="token punctuation">[</span>count<span class="token punctuation">]</span><span class="token punctuation">.</span>title<span class="token punctuation">,</span>
			library<span class="token punctuation">[</span>count<span class="token punctuation">]</span><span class="token punctuation">.</span>author<span class="token punctuation">,</span> library<span class="token punctuation">[</span>count<span class="token punctuation">]</span><span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
		count<span class="token operator">++</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	filecount <span class="token operator">=</span> count<span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>count <span class="token operator">==</span> MAXBKS<span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token function">fputs</span><span class="token punctuation">(</span><span class="token string">&quot;The book.dat file is full.&quot;</span><span class="token punctuation">,</span> <span class="token constant">stderr</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">&quot;Please add new book titles.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">&quot;Press [enter] at the start of a line to stop.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">while</span> <span class="token punctuation">(</span>count <span class="token operator">&lt;</span> MAXBKS <span class="token operator">&amp;&amp;</span> <span class="token function">s_gets</span><span class="token punctuation">(</span>library<span class="token punctuation">[</span>count<span class="token punctuation">]</span><span class="token punctuation">.</span>title<span class="token punctuation">,</span> MAXTITL<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token constant">NULL</span>
		<span class="token operator">&amp;&amp;</span> library<span class="token punctuation">[</span>count<span class="token punctuation">]</span><span class="token punctuation">.</span>title<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token string">'\0'</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">&quot;Now enter the author.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">s_gets</span><span class="token punctuation">(</span>library<span class="token punctuation">[</span>count<span class="token punctuation">]</span><span class="token punctuation">.</span>author<span class="token punctuation">,</span> MAXAULT<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">&quot;Now enter the value.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">&quot;%f&quot;</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>library<span class="token punctuation">[</span>count<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token string">'\n'</span><span class="token punctuation">)</span>
			<span class="token keyword">continue</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>count <span class="token operator">&lt;</span> MAXBKS<span class="token punctuation">)</span>
			<span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">&quot;Enter the next title.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>count <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">&quot;Here is the list of your books:&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">for</span> <span class="token punctuation">(</span>index <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> index <span class="token operator">&lt;</span> count<span class="token punctuation">;</span> index<span class="token operator">++</span><span class="token punctuation">)</span>
			<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;%s by %s:$%.2f\n&quot;</span><span class="token punctuation">,</span> library<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">.</span>title<span class="token punctuation">,</span>
				library<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">.</span>author<span class="token punctuation">,</span> library<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">fwrite</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>library<span class="token punctuation">[</span>filecount<span class="token punctuation">]</span><span class="token punctuation">,</span> size<span class="token punctuation">,</span> count <span class="token operator">-</span> filecount<span class="token punctuation">,</span> pbooks<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">else</span>
		<span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">&quot;No books.\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">&quot;Bye.\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
 
<span class="token punctuation">}</span>
 
<span class="token keyword">char</span> <span class="token operator">*</span> <span class="token function">s_gets</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span> st<span class="token punctuation">,</span> <span class="token keyword">int</span> n<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">char</span> <span class="token operator">*</span> ret_val<span class="token punctuation">;</span>
	<span class="token keyword">char</span> <span class="token operator">*</span> find<span class="token punctuation">;</span>
	ret_val <span class="token operator">=</span> <span class="token function">fgets</span><span class="token punctuation">(</span>st<span class="token punctuation">,</span> n<span class="token punctuation">,</span> <span class="token constant">stdin</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>ret_val<span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		find <span class="token operator">=</span> <span class="token function">strchr</span><span class="token punctuation">(</span>st<span class="token punctuation">,</span> <span class="token string">'\n'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//查找换行符</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>find<span class="token punctuation">)</span>
			<span class="token operator">*</span>find <span class="token operator">=</span> <span class="token string">'\0'</span><span class="token punctuation">;</span> <span class="token comment">//将换行符换成'\0'</span>
		<span class="token keyword">else</span>
			<span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token string">'\n'</span><span class="token punctuation">)</span>  <span class="token comment">//处理输入行剩余的字符</span>
				<span class="token keyword">continue</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span> ret_val<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></details> <h3 id="链式结构"><a href="#链式结构" class="header-anchor">#</a> 链式结构</h3> <h3 id="联合简介"><a href="#联合简介" class="header-anchor">#</a> 联合简介</h3> <p>联合(<em>union</em>)是一种数据类型，能在同一个内存空间存储不同的数据类型。</p> <p>定义联合：</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">union</span> hold <span class="token punctuation">{</span>
    <span class="token keyword">int</span> digit<span class="token punctuation">;</span>
    <span class="token keyword">double</span> bigfl<span class="token punctuation">;</span>
    <span class="token keyword">char</span> letter<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>hold的联合体可以存储一个 <code>int</code> 或一个 <code>double</code> 或一个 <code>char</code>，同一时刻只能三个中的一个。</p> <h3 id="枚举类型"><a href="#枚举类型" class="header-anchor">#</a> 枚举类型</h3> <p>(enumerated type)</p> <p>可以声明符号名称代替整型常量</p> <p>enum spectrum {red, orange, yellow, green, blue, violet};</p> <h3 id="typedef简介（别名）"><a href="#typedef简介（别名）" class="header-anchor">#</a> typedef简介（别名）</h3> <p>typedef char * STRING</p> <p>STRING name , sign ;// 等价char * name , * sign;</p> <h3 id="其他复杂的声明"><a href="#其他复杂的声明" class="header-anchor">#</a> 其他复杂的声明</h3> <h3 id="函数和指针-2"><a href="#函数和指针-2" class="header-anchor">#</a> 函数和指针</h3> <p>函数也有地址，指向函数的指针中存储着函数代码的起始位置。</p> <p>函数指针需要指明函数的返回类型和参数类型：</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">void</span> <span class="token function">ToUpper</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span> <span class="token comment">//函数</span>
<span class="token keyword">void</span> <span class="token punctuation">(</span><span class="token operator">*</span>pf<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span> <span class="token punctuation">)</span> <span class="token comment">//对应的函数指针</span>
</code></pre></div><p>声明了函数指针后，可以把类型匹配的函数地址（函数名）赋值给他。</p> <h2 id="ch15-位操作"><a href="#ch15-位操作" class="header-anchor">#</a> Ch15 位操作</h2> <p>和硬件关系较为密切，一般情况下不会直接进行位操作。（略）</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><!----> <span class="next"><a href="/study_2/ccpp/cexercises.html">
        C Exercises
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.3a4d85d6.js" defer></script><script src="/assets/js/2.df84aaee.js" defer></script><script src="/assets/js/11.7b015660.js" defer></script>
  </body>
</html>
